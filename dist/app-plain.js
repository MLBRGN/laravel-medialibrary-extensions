import"./image-editor-listener.js";import"./index.es.js";function S(t,n){const s=new CustomEvent(t,{bubbles:!0,detail:{element:n}});n.dispatchEvent(s)}function x(t){const n='a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])',s=()=>Array.from(t.querySelectorAll(n)).filter(d=>!d.hasAttribute("disabled")&&d.offsetParent!==null),c=d=>{const v=s();console.log(v);const e=v[0],i=v[v.length-1];if(d.key==="Tab"){if(v.length===0)return;d.shiftKey?document.activeElement===e&&(d.preventDefault(),i.focus()):document.activeElement===i&&(d.preventDefault(),e.focus())}};t.addEventListener("keydown",c),t._trapFocusHandler=c;const h=s();h.length&&h[0].focus()}function T(t){t._trapFocusHandler&&(t.removeEventListener("keydown",t._trapFocusHandler),delete t._trapFocusHandler)}const I=new Map;function q(t){return I.get(t)}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-carousel]").forEach(t=>{console.log("carousel",t);const n=t.querySelectorAll(".media-carousel-item"),s=t.querySelectorAll(".media-carousel-indicators button"),c=t.querySelector('[data-slide="prev"]'),h=t.querySelector('[data-slide="next"]');console.log("prev",c,"next",h),c===null&&console.log(t);const d=t.getAttribute("data-carousel-ride")==="true",v=Number(t.getAttribute("data-carousel-ride-interval")??"5000"),e=t.getAttribute("data-carousel-ride-only-after-interaction")==="true";let i=0,l=!1,o=null,a=0,f=0,p=0,w=0;const M=50,C=(r,u="right")=>{n.forEach(b=>{b.classList.remove("active","slide-in-from-left","slide-in-from-right","slide-out-to-left","slide-out-to-right")});const L=n[i],E=n[r];t.getAttribute("data-carousel-effect")==="slide"&&(t.classList.contains("temp-no-animation")||t.classList.contains("no-animation")||(u==="right"?(E.classList.add("slide-in-from-right"),L.classList.add("slide-out-to-left")):(E.classList.add("slide-in-from-left"),L.classList.add("slide-out-to-right")),E.offsetWidth)),L.classList.remove("active"),E.classList.add("active"),s.forEach((b,P)=>b.classList.toggle("active",P===r)),i=r,S("carouselSlided",t)},g=(r,u=!1)=>{if(r===i)return;const L=(r+n.length)%n.length,b=(L-i+n.length)%n.length>n.length/2?"left":"right";u&&t.classList.add("temp-no-animation"),C(L,b),u&&setTimeout(()=>{t.classList.remove("temp-no-animation")},1e3)},D=()=>{const u=f-a;Math.abs(u)>40&&Math.abs(u)>Math.abs(w-p)&&(u<0?g((i+1)%n.length):g((i-1+n.length)%n.length),m())},y=()=>{A(),o=setInterval(()=>{g((i+1)%n.length)},v)},A=()=>{o!==null&&(clearInterval(o),o=null)},m=()=>{l||(l=!0,d&&e&&y()),d&&!e&&y()};s.forEach((r,u)=>{r.addEventListener("click",()=>{g(u),m()})}),c==null||c.addEventListener("click",()=>{console.log("prev slide"),g((i-1+n.length)%n.length),m()}),h==null||h.addEventListener("click",()=>{console.log("next slide"),g((i+1)%n.length),m()}),t.addEventListener("mouseenter",A),t.addEventListener("mouseleave",()=>{d&&(!e||l)&&y()}),t.addEventListener("focusin",A),t.addEventListener("focusout",()=>{d&&(!e||l)&&y()}),t.addEventListener("keydown",r=>{r.key==="ArrowLeft"?(r.preventDefault(),g((i-1+n.length)%n.length),m()):r.key==="ArrowRight"&&(r.preventDefault(),g((i+1)%n.length),m())}),t.addEventListener("touchstart",r=>{a=r.changedTouches[0].screenX,p=r.changedTouches[0].screenY},{passive:!0}),t.addEventListener("touchend",r=>{f=r.changedTouches[0].screenX,w=r.changedTouches[0].screenY,Math.abs(w-p)<M&&D()},{passive:!0}),n.length>1&&d&&!e&&y();const k={goToSlide:(r,u=!1)=>g(r,u),getCurrentIndex:()=>i,goToNextSlide:()=>g((i+1)%n.length),goToPreviousSlide:()=>g((i-1+n.length)%n.length),pause:A,resume:y};I.set(t,k),t._carouselController=k})});document.addEventListener("DOMContentLoaded",()=>{const t={};function n(e,i=0){console.log("openModal",e,"slideTo",i);const l=document.querySelector(e);if(!l)return console.warn("Modal not found:",e);l.classList.add("active"),l.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",x(l);const o=l.querySelector("[data-carousel]"),a=q(o);a&&a.goToSlide(parseInt(i),!0),S("modalOpened",l)}function s(e){e.classList.remove("active"),e.setAttribute("aria-hidden","true"),document.body.style.overflow="",T(e),S("modalClosed",e)}document.addEventListener("click",e=>{const i=e.target;console.log("target",i);const l=e.target.closest("[data-modal-trigger]");if(l){console.log("found trigger",l),e.preventDefault(),n(l.getAttribute("data-modal-trigger"),l.getAttribute("data-slide-to")||0);return}const o=e.target.closest("[data-modal-close]");if(o){const f=o.closest("[data-modal]");f&&s(f);return}const a=e.target.closest("[data-modal]");a&&e.target===a&&s(a)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&document.querySelectorAll("[data-modal].active").forEach(s)});function c(e){const i=e.querySelector("[data-carousel]"),l=e.hasAttribute("data-video-autoplay");e.addEventListener("liteYoutubeIframeLoaded",o=>{const a=o.target.closest("[data-youtube-video-id]");if(!a)return;const f=a.getAttribute("data-youtube-video-id"),p=a.querySelector("lite-youtube").shadowRoot.querySelector("iframe");t[f]=new YT.Player(p,{events:{onReady:()=>{}}})}),e.addEventListener("modalOpened",()=>{if(!l)return;const o=e.querySelector(".media-carousel-item.active");if(!o)return;const a=o.querySelector(".media-video-container[data-youtube-video-id]");a&&v(a.getAttribute("data-youtube-video-id"))}),e.addEventListener("modalClosed",h),e.addEventListener("keydown",o=>{if(!e.classList.contains("active"))return;const a=e.querySelector("[data-carousel]");if(!a)return;const f=q(a);if(!f)return;const p=a.contains(o.target);if(o.key==="Escape"){s(e),o.stopPropagation(),o.preventDefault();return}(o.key==="ArrowLeft"||o.key==="ArrowRight")&&p||(o.key==="ArrowLeft"?(o.preventDefault(),o.stopPropagation(),f.goToPreviousSlide()):o.key==="ArrowRight"&&(o.preventDefault(),o.stopPropagation(),f.goToNextSlide()))}),document.addEventListener("onImageUpdated",o=>{console.log("âœ… Global listener got event:",o.detail)}),e.addEventListener("onImageUpdated",o=>{console.log("onImageUpdated",o)}),i&&i.addEventListener("carouselSlided",()=>{if(d(),!l)return;const o=i.querySelector(".media-carousel-item.active");if(!o)return;const a=o.querySelector(".media-video-container[data-youtube-video-id]");a&&v(a.getAttribute("data-youtube-video-id"))})}function h(){Object.values(t).forEach(e=>e.stopVideo())}function d(){Object.values(t).forEach(e=>e.pauseVideo())}function v(e){const i=t[e];i&&i.playVideo()}document.querySelectorAll("[data-modal]").forEach(c)});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".image-editor-modal").forEach(s=>{s.addEventListener("onImageUpdated",c=>{console.log("onImageUpdated",c),n(s)})});function n(s){s.classList.remove("active"),s.setAttribute("aria-hidden","true"),document.body.style.overflow="",T(s),S("modalClosed",s)}});

import"./image-editor-listener.js";import"./index.es.js";function S(e,i){const s=new CustomEvent(e,{bubbles:!0,detail:{element:i}});i.dispatchEvent(s)}function x(e){const i='a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])',s=()=>Array.from(e.querySelectorAll(i)).filter(l=>!l.hasAttribute("disabled")&&l.offsetParent!==null),c=l=>{const g=s();console.log(g);const t=g[0],n=g[g.length-1];if(l.key==="Tab"){if(g.length===0)return;l.shiftKey?document.activeElement===t&&(l.preventDefault(),n.focus()):document.activeElement===n&&(l.preventDefault(),t.focus())}};e.addEventListener("keydown",c),e._trapFocusHandler=c;const v=s();v.length&&v[0].focus()}function I(e){e._trapFocusHandler&&(e.removeEventListener("keydown",e._trapFocusHandler),delete e._trapFocusHandler)}const T=new Map;function q(e){return T.get(e)}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-carousel]").forEach(e=>{console.log("carousel",e);const i=e.querySelectorAll(".media-carousel-item"),s=e.querySelectorAll(".media-carousel-indicators button"),c=e.querySelector('[data-slide="prev"]'),v=e.querySelector('[data-slide="next"]');console.log("prev",c,"next",v),c===null&&console.log(e);const l=e.getAttribute("data-carousel-ride")==="true",g=Number(e.getAttribute("data-carousel-ride-interval")??"5000"),t=e.getAttribute("data-carousel-ride-only-after-interaction")==="true";let n=0,d=!1,o=null,a=0,h=0,p=0,w=0;const M=50,C=(r,u="right")=>{i.forEach(y=>{y.classList.remove("active","slide-in-from-left","slide-in-from-right","slide-out-to-left","slide-out-to-right"),y.style.zIndex=0});const b=i[n],E=i[r];e.getAttribute("data-carousel-effect")==="slide"&&(e.classList.contains("temp-no-animation")||e.classList.contains("no-animation")||(u==="right"?(E.classList.add("slide-in-from-right"),b.classList.add("slide-out-to-left")):(E.classList.add("slide-in-from-left"),b.classList.add("slide-out-to-right")),E.offsetWidth)),b.classList.remove("active"),E.classList.add("active"),s.forEach((y,P)=>y.classList.toggle("active",P===r)),n=r,S("carouselSlided",e)},f=(r,u=!1)=>{if(r===n)return;const b=(r+i.length)%i.length,y=(b-n+i.length)%i.length>i.length/2?"left":"right";u&&e.classList.add("temp-no-animation"),C(b,y),u&&setTimeout(()=>{e.classList.remove("temp-no-animation")},1e3)},D=()=>{const u=h-a;Math.abs(u)>40&&Math.abs(u)>Math.abs(w-p)&&(u<0?f((n+1)%i.length):f((n-1+i.length)%i.length),L())},m=()=>{A(),o=setInterval(()=>{f((n+1)%i.length)},g)},A=()=>{o!==null&&(clearInterval(o),o=null)},L=()=>{d||(d=!0,l&&t&&m()),l&&!t&&m()};s.forEach((r,u)=>{r.addEventListener("click",()=>{f(u),L()})}),c==null||c.addEventListener("click",()=>{console.log("prev slide"),f((n-1+i.length)%i.length),L()}),v==null||v.addEventListener("click",()=>{console.log("next slide"),f((n+1)%i.length),L()}),e.addEventListener("mouseenter",A),e.addEventListener("mouseleave",()=>{l&&(!t||d)&&m()}),e.addEventListener("focusin",A),e.addEventListener("focusout",()=>{l&&(!t||d)&&m()}),e.addEventListener("keydown",r=>{r.key==="ArrowLeft"?(r.preventDefault(),f((n-1+i.length)%i.length),L()):r.key==="ArrowRight"&&(r.preventDefault(),f((n+1)%i.length),L())}),e.addEventListener("touchstart",r=>{a=r.changedTouches[0].screenX,p=r.changedTouches[0].screenY},{passive:!0}),e.addEventListener("touchend",r=>{h=r.changedTouches[0].screenX,w=r.changedTouches[0].screenY,Math.abs(w-p)<M&&D()},{passive:!0}),i.length>1&&l&&!t&&m();const k={goToSlide:(r,u=!1)=>f(r,u),getCurrentIndex:()=>n,goToNextSlide:()=>f((n+1)%i.length),goToPreviousSlide:()=>f((n-1+i.length)%i.length),pause:A,resume:m};T.set(e,k),e._carouselController=k})});document.addEventListener("DOMContentLoaded",()=>{const e={};function i(t,n=0){console.log("openModal",t,"slideTo",n);const d=document.querySelector(t);if(!d)return console.warn("Modal not found:",t);d.classList.add("active"),d.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",x(d);const o=d.querySelector("[data-carousel]"),a=q(o);a&&a.goToSlide(parseInt(n),!0),S("modalOpened",d)}function s(t){t.classList.remove("active"),t.setAttribute("aria-hidden","true"),document.body.style.overflow="",I(t),S("modalClosed",t)}document.addEventListener("click",t=>{const n=t.target.closest("[data-modal-trigger]");if(n){console.log("found trigger",n),t.preventDefault(),i(n.getAttribute("data-modal-trigger"),n.getAttribute("data-slide-to")||0);return}const d=t.target.closest("[data-modal-close]");if(d){const a=d.closest("[data-modal]");a&&s(a);return}const o=t.target.closest("[data-modal]");o&&t.target===o&&s(o)}),document.addEventListener("keydown",t=>{t.key==="Escape"&&document.querySelectorAll("[data-modal].active").forEach(s)});function c(t){const n=t.querySelector("[data-carousel]"),d=t.hasAttribute("data-video-autoplay");t.addEventListener("liteYoutubeIframeLoaded",o=>{const a=o.target.closest("[data-youtube-video-id]");if(!a)return;const h=a.getAttribute("data-youtube-video-id"),p=a.querySelector("lite-youtube").shadowRoot.querySelector("iframe");e[h]=new YT.Player(p,{events:{onReady:()=>{}}})}),t.addEventListener("modalOpened",()=>{if(!d)return;const o=t.querySelector(".media-carousel-item.active");if(!o)return;const a=o.querySelector(".media-video-container[data-youtube-video-id]");a&&g(a.getAttribute("data-youtube-video-id"))}),t.addEventListener("modalClosed",v),t.addEventListener("keydown",o=>{if(!t.classList.contains("active"))return;const a=t.querySelector("[data-carousel]");if(!a)return;const h=q(a);if(!h)return;const p=a.contains(o.target);if(o.key==="Escape"){s(t),o.stopPropagation(),o.preventDefault();return}(o.key==="ArrowLeft"||o.key==="ArrowRight")&&p||(o.key==="ArrowLeft"?(o.preventDefault(),o.stopPropagation(),h.goToPreviousSlide()):o.key==="ArrowRight"&&(o.preventDefault(),o.stopPropagation(),h.goToNextSlide()))}),document.addEventListener("onImageUpdated",o=>{console.log("âœ… Global listener got event:",o.detail)}),t.addEventListener("onImageUpdated",o=>{console.log("onImageUpdated",o)}),n&&n.addEventListener("carouselSlided",()=>{if(l(),!d)return;const o=n.querySelector(".media-carousel-item.active");if(!o)return;const a=o.querySelector(".media-video-container[data-youtube-video-id]");a&&g(a.getAttribute("data-youtube-video-id"))})}function v(){Object.values(e).forEach(t=>t.stopVideo())}function l(){Object.values(e).forEach(t=>t.pauseVideo())}function g(t){const n=e[t];n&&n.playVideo()}document.querySelectorAll("[data-modal]").forEach(c)});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".image-editor-modal").forEach(s=>{s.addEventListener("onImageUpdated",c=>{console.log("onImageUpdated",c),i(s)})});function i(s){s.classList.remove("active"),s.setAttribute("aria-hidden","true"),document.body.style.overflow="",I(s),S("modalClosed",s)}});

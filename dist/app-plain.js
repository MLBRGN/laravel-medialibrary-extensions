import"./image-editor-listener.js";import"./index.es.js";function S(t,n){const s=new CustomEvent(t,{bubbles:!0,detail:{element:n}});n.dispatchEvent(s)}function O(t){const n='a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])',s=()=>Array.from(t.querySelectorAll(n)).filter(l=>!l.hasAttribute("disabled")&&l.offsetParent!==null),f=l=>{const v=s();console.log(v);const e=v[0],a=v[v.length-1];if(l.key==="Tab"){if(v.length===0)return;l.shiftKey?document.activeElement===e&&(l.preventDefault(),a.focus()):document.activeElement===a&&(l.preventDefault(),e.focus())}};t.addEventListener("keydown",f),t._trapFocusHandler=f;const g=s();g.length&&g[0].focus()}function q(t){t._trapFocusHandler&&(t.removeEventListener("keydown",t._trapFocusHandler),delete t._trapFocusHandler)}const T=new Map;function I(t){return T.get(t)}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-carousel]").forEach(t=>{const n=t.querySelectorAll(".media-carousel-item"),s=t.querySelectorAll(".media-carousel-indicators button"),f=t.querySelector('[data-slide="prev"]'),g=t.querySelector('[data-slide="next"]'),l=t.getAttribute("data-carousel-ride")==="true",v=Number(t.getAttribute("data-carousel-ride-interval")??"5000"),e=t.getAttribute("data-carousel-ride-only-after-interaction")==="true";let a=0,d=!1,o=null,i=0,h=0,y=0,w=0;const C=50,M=(r,c="right")=>{n.forEach(m=>{m.classList.remove("active","slide-in-from-left","slide-in-from-right","slide-out-to-left","slide-out-to-right"),m.style.zIndex=0});const b=n[a],E=n[r];t.getAttribute("data-carousel-effect")==="slide"&&(t.classList.contains("temp-no-animation")||t.classList.contains("no-animation")||(c==="right"?(E.classList.add("slide-in-from-right"),b.classList.add("slide-out-to-left")):(E.classList.add("slide-in-from-left"),b.classList.add("slide-out-to-right")),E.offsetWidth)),b.classList.remove("active"),E.classList.add("active"),s.forEach((m,P)=>m.classList.toggle("active",P===r)),a=r,S("carouselSlided",t)},u=(r,c=!1)=>{if(r===a)return;const b=(r+n.length)%n.length,m=(b-a+n.length)%n.length>n.length/2?"left":"right";c&&t.classList.add("temp-no-animation"),M(b,m),c&&setTimeout(()=>{t.classList.remove("temp-no-animation")},1e3)},D=()=>{const c=h-i;Math.abs(c)>40&&Math.abs(c)>Math.abs(w-y)&&(c<0?u((a+1)%n.length):u((a-1+n.length)%n.length),L())},p=()=>{A(),o=setInterval(()=>{u((a+1)%n.length)},v)},A=()=>{o!==null&&(clearInterval(o),o=null)},L=()=>{d||(d=!0,l&&e&&p()),l&&!e&&p()};s.forEach((r,c)=>{r.addEventListener("click",()=>{u(c),L()})}),f==null||f.addEventListener("click",()=>{u((a-1+n.length)%n.length),L()}),g==null||g.addEventListener("click",()=>{u((a+1)%n.length),L()}),t.addEventListener("mouseenter",A),t.addEventListener("mouseleave",()=>{l&&(!e||d)&&p()}),t.addEventListener("focusin",A),t.addEventListener("focusout",()=>{l&&(!e||d)&&p()}),t.addEventListener("keydown",r=>{r.key==="ArrowLeft"?(r.preventDefault(),u((a-1+n.length)%n.length),L()):r.key==="ArrowRight"&&(r.preventDefault(),u((a+1)%n.length),L())}),t.addEventListener("touchstart",r=>{i=r.changedTouches[0].screenX,y=r.changedTouches[0].screenY},{passive:!0}),t.addEventListener("touchend",r=>{h=r.changedTouches[0].screenX,w=r.changedTouches[0].screenY,Math.abs(w-y)<C&&D()},{passive:!0}),n.length>1&&l&&!e&&p();const k={goToSlide:(r,c=!1)=>u(r,c),getCurrentIndex:()=>a,goToNextSlide:()=>u((a+1)%n.length),goToPreviousSlide:()=>u((a-1+n.length)%n.length),pause:A,resume:p};T.set(t,k),t._carouselController=k})});document.addEventListener("DOMContentLoaded",()=>{const t={};function n(e,a=0){const d=document.getElementById(e);if(!d)return console.warn("Modal not found:",e);d.classList.add("active"),d.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",O(d);const o=d.querySelector("[data-carousel]"),i=I(o);i&&i.goToSlide(parseInt(a),!0),S("modalOpened",d)}function s(e){e.classList.remove("active"),e.setAttribute("aria-hidden","true"),document.body.style.overflow="",q(e),S("modalClosed",e)}document.addEventListener("click",e=>{const a=e.target.closest("[data-modal-trigger]");if(a){e.preventDefault(),n(a.getAttribute("data-modal-trigger"),a.getAttribute("data-slide-to")||0);return}const d=e.target.closest("[data-modal-close]");if(d){const i=d.closest("[data-modal]");i&&s(i);return}const o=e.target.closest("[data-modal]");o&&e.target===o&&s(o)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&document.querySelectorAll("[data-modal].active").forEach(s)});function f(e){const a=e.querySelector("[data-carousel]"),d=e.hasAttribute("data-video-autoplay");e.addEventListener("liteYoutubeIframeLoaded",o=>{const i=o.target.closest("[data-youtube-video-id]");if(!i)return;const h=i.getAttribute("data-youtube-video-id"),y=i.querySelector("lite-youtube").shadowRoot.querySelector("iframe");t[h]=new YT.Player(y,{events:{onReady:()=>{}}})}),e.addEventListener("modalOpened",()=>{if(!d)return;const o=e.querySelector(".media-carousel-item.active");if(!o)return;const i=o.querySelector(".media-video-container[data-youtube-video-id]");i&&v(i.getAttribute("data-youtube-video-id"))}),e.addEventListener("modalClosed",g),e.addEventListener("keydown",o=>{if(!e.classList.contains("active"))return;const i=e.querySelector("[data-carousel]");if(!i)return;const h=I(i);if(!h)return;const y=i.contains(o.target);if(o.key==="Escape"){s(e),o.stopPropagation(),o.preventDefault();return}(o.key==="ArrowLeft"||o.key==="ArrowRight")&&y||(o.key==="ArrowLeft"?(o.preventDefault(),o.stopPropagation(),h.goToPreviousSlide()):o.key==="ArrowRight"&&(o.preventDefault(),o.stopPropagation(),h.goToNextSlide()))}),document.addEventListener("onImageUpdated",o=>{console.log("âœ… Global listener got event:",o.detail)}),e.addEventListener("onImageUpdated",o=>{console.log("onImageUpdated",o)}),a&&a.addEventListener("carouselSlided",()=>{if(l(),!d)return;const o=a.querySelector(".media-carousel-item.active");if(!o)return;const i=o.querySelector(".media-video-container[data-youtube-video-id]");i&&v(i.getAttribute("data-youtube-video-id"))})}function g(){Object.values(t).forEach(e=>e.stopVideo())}function l(){Object.values(t).forEach(e=>e.pauseVideo())}function v(e){const a=t[e];a&&a.playVideo()}document.querySelectorAll("[data-modal]").forEach(f)});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".image-editor-modal").forEach(s=>{s.addEventListener("onImageUpdated",f=>{console.log("onImageUpdated",f),n(s)})});function n(s){s.classList.remove("active"),s.setAttribute("aria-hidden","true"),document.body.style.overflow="",q(s),S("modalClosed",s)}});

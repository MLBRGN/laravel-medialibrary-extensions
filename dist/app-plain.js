import"./image-editor-listener.js";import"./index.es.js";function k(e,t){const r=new CustomEvent(e,{bubbles:!0,detail:{element:t}});t.dispatchEvent(r)}function F(e){const t='a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])',r=()=>Array.from(e.querySelectorAll(t)).filter(s=>!s.hasAttribute("disabled")&&s.offsetParent!==null),o=s=>{const d=r();console.log(d);const l=d[0],i=d[d.length-1];if(s.key==="Tab"){if(d.length===0)return;s.shiftKey?document.activeElement===l&&(s.preventDefault(),i.focus()):document.activeElement===i&&(s.preventDefault(),l.focus())}};e.addEventListener("keydown",o),e._trapFocusHandler=o;const n=r();n.length&&n[0].focus()}function R(e){e._trapFocusHandler&&(e.removeEventListener("keydown",e._trapFocusHandler),delete e._trapFocusHandler)}const C=new Map;function M(e){return C.get(e)}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-carousel]").forEach(e=>{console.log("carousel",e);const t=e.querySelectorAll(".media-carousel-item"),r=e.querySelectorAll(".media-carousel-indicators button"),o=e.querySelector('[data-slide="prev"]'),n=e.querySelector('[data-slide="next"]');console.log("prev",o,"next",n),o===null&&console.log(e);const s=e.getAttribute("data-carousel-ride")==="true",d=Number(e.getAttribute("data-carousel-ride-interval")??"5000"),l=e.getAttribute("data-carousel-ride-only-after-interaction")==="true";let i=0,p=!1,L=null,q=0,w=0,A=0,S=0;const x=50,O=(a,c="right")=>{t.forEach(v=>{v.classList.remove("active","slide-in-from-left","slide-in-from-right","slide-out-to-left","slide-out-to-right")});const h=t[i],y=t[a];e.getAttribute("data-carousel-effect")==="slide"&&(e.classList.contains("temp-no-animation")||e.classList.contains("no-animation")||(c==="right"?(y.classList.add("slide-in-from-right"),h.classList.add("slide-out-to-left")):(y.classList.add("slide-in-from-left"),h.classList.add("slide-out-to-right")),y.offsetWidth)),h.classList.remove("active"),y.classList.add("active"),r.forEach((v,V)=>v.classList.toggle("active",V===a)),i=a,k("carouselSlided",e)},u=(a,c=!1)=>{if(a===i)return;const h=(a+t.length)%t.length,v=(h-i+t.length)%t.length>t.length/2?"left":"right";c&&e.classList.add("temp-no-animation"),O(h,v),c&&setTimeout(()=>{e.classList.remove("temp-no-animation")},1e3)},P=()=>{const c=w-q;Math.abs(c)>40&&Math.abs(c)>Math.abs(S-A)&&(c<0?u((i+1)%t.length):u((i-1+t.length)%t.length),g())},f=()=>{E(),L=setInterval(()=>{u((i+1)%t.length)},d)},E=()=>{L!==null&&(clearInterval(L),L=null)},g=()=>{p||(p=!0,s&&l&&f()),s&&!l&&f()};r.forEach((a,c)=>{a.addEventListener("click",()=>{u(c),g()})}),o==null||o.addEventListener("click",()=>{console.log("prev slide"),u((i-1+t.length)%t.length),g()}),n==null||n.addEventListener("click",()=>{console.log("next slide"),u((i+1)%t.length),g()}),e.addEventListener("mouseenter",E),e.addEventListener("mouseleave",()=>{s&&(!l||p)&&f()}),e.addEventListener("focusin",E),e.addEventListener("focusout",()=>{s&&(!l||p)&&f()}),e.addEventListener("keydown",a=>{a.key==="ArrowLeft"?(a.preventDefault(),u((i-1+t.length)%t.length),g()):a.key==="ArrowRight"&&(a.preventDefault(),u((i+1)%t.length),g())}),e.addEventListener("touchstart",a=>{q=a.changedTouches[0].screenX,A=a.changedTouches[0].screenY},{passive:!0}),e.addEventListener("touchend",a=>{w=a.changedTouches[0].screenX,S=a.changedTouches[0].screenY,Math.abs(S-A)<x&&P()},{passive:!0}),t.length>1&&s&&!l&&f();const I={goToSlide:(a,c=!1)=>u(a,c),getCurrentIndex:()=>i,goToNextSlide:()=>u((i+1)%t.length),goToPreviousSlide:()=>u((i-1+t.length)%t.length),pause:E,resume:f};C.set(e,I),e._carouselController=I})});function m(e){e.classList.remove("active"),e.setAttribute("aria-hidden","true"),document.body.style.overflow="",R(e),k("modalClosed",e)}function Y(e,t=0,r=null){const o=document.querySelector(e);o&&(o.classList.add("active"),o.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",F(o),r&&r.goToSlide(parseInt(t),!0),k("modalOpened",o))}function D(e,t=()=>{},r=()=>{}){e.addEventListener("modalOpened",r),e.addEventListener("modalClosed",t),document.addEventListener("onImageUpdated",o=>{console.log("âœ… Global listener got event:",o.detail)}),e.addEventListener("onImageUpdated",o=>{console.log("onImageUpdated",o),m(e)})}const b={};function B(){Object.values(b).forEach(e=>e.stopVideo())}function _(){Object.values(b).forEach(e=>e.pauseVideo())}function T(e){const t=b[e];t&&t.playVideo()}function H(e){const t=e.querySelector("[data-carousel]"),r=e.hasAttribute("data-video-autoplay");D(e,B,()=>{if(!r)return;const o=e.querySelector(".media-carousel-item.active"),n=o==null?void 0:o.querySelector(".media-video-container[data-youtube-video-id]");n&&T(n.getAttribute("data-youtube-video-id"))}),e.addEventListener("keydown",o=>{if(!e.classList.contains("active"))return;const n=M(e.querySelector("[data-carousel]"));if(!n)return;const s=e.querySelector("[data-carousel]").contains(o.target);if(o.key==="Escape"){m(e),o.preventDefault();return}(o.key==="ArrowLeft"||o.key==="ArrowRight")&&s||(o.key==="ArrowLeft"?n.goToPreviousSlide():o.key==="ArrowRight"&&n.goToNextSlide())}),t==null||t.addEventListener("carouselSlided",()=>{if(_(),!r)return;const o=t.querySelector(".media-carousel-item.active"),n=o==null?void 0:o.querySelector(".media-video-container[data-youtube-video-id]");n&&T(n.getAttribute("data-youtube-video-id"))}),e.addEventListener("liteYoutubeIframeLoaded",o=>{var l,i;const n=o.target.closest("[data-youtube-video-id]"),s=n==null?void 0:n.getAttribute("data-youtube-video-id"),d=(i=(l=n==null?void 0:n.querySelector("lite-youtube"))==null?void 0:l.shadowRoot)==null?void 0:i.querySelector("iframe");s&&d&&(b[s]=new YT.Player(d))})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-modal]").forEach(H),document.addEventListener("click",e=>{const t=e.target.closest("[data-modal-trigger]");if(t){e.preventDefault();const n=t.getAttribute("data-modal-trigger"),s=t.getAttribute("data-slide-to")||0,d=document.querySelector(n),l=M(d==null?void 0:d.querySelector("[data-carousel]"));Y(n,s,l);return}const r=e.target.closest("[data-modal-close]");if(r){const n=r.closest("[data-modal]");n&&m(n);return}const o=e.target.closest("[data-modal]");o&&e.target===o&&m(o)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&document.querySelectorAll("[data-modal].active").forEach(m)})});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-image-editor-modal]").forEach(e=>{D(e,()=>{},()=>{})})});

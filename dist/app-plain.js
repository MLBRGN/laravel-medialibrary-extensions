import"./image-editor-listener.js";import"./index.es.js";function S(e,n){const l=new CustomEvent(e,{bubbles:!0,detail:{element:n}});n.dispatchEvent(l)}function O(e){const n='a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])',l=()=>Array.from(e.querySelectorAll(n)).filter(u=>!u.hasAttribute("disabled")&&u.offsetParent!==null),r=u=>{const h=l();console.log(h);const t=h[0],a=h[h.length-1];if(u.key==="Tab"){if(h.length===0)return;u.shiftKey?document.activeElement===t&&(u.preventDefault(),a.focus()):document.activeElement===a&&(u.preventDefault(),t.focus())}};e.addEventListener("keydown",r),e._trapFocusHandler=r;const c=l();c.length&&c[0].focus()}function q(e){e._trapFocusHandler&&(e.removeEventListener("keydown",e._trapFocusHandler),delete e._trapFocusHandler)}const T=new Map;function I(e){return T.get(e)}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-carousel]").forEach(e=>{console.log("carousel",e);const n=e.querySelectorAll(".media-carousel-item"),l=e.querySelectorAll(".media-carousel-indicators button"),r=e.querySelector('[data-slide="prev"]'),c=e.querySelector('[data-slide="next"]');console.log("prev",r,"next",c),r===null&&console.log(e);const u=e.getAttribute("data-carousel-ride")==="true",h=Number(e.getAttribute("data-carousel-ride-interval")??"5000"),t=e.getAttribute("data-carousel-ride-only-after-interaction")==="true";let a=0,d=!1,o=null,i=0,g=0,p=0,w=0;const M=50,C=(s,f="right")=>{n.forEach(E=>{E.classList.remove("active","slide-in-from-left","slide-in-from-right","slide-out-to-left","slide-out-to-right")});const L=n[a],b=n[s];e.getAttribute("data-carousel-effect")==="slide"&&(e.classList.contains("temp-no-animation")||e.classList.contains("no-animation")||(f==="right"?(b.classList.add("slide-in-from-right"),L.classList.add("slide-out-to-left")):(b.classList.add("slide-in-from-left"),L.classList.add("slide-out-to-right")),b.offsetWidth)),L.classList.remove("active"),b.classList.add("active"),l.forEach((E,P)=>E.classList.toggle("active",P===s)),a=s,S("carouselSlided",e)},v=(s,f=!1)=>{if(s===a)return;const L=(s+n.length)%n.length,E=(L-a+n.length)%n.length>n.length/2?"left":"right";f&&e.classList.add("temp-no-animation"),C(L,E),f&&setTimeout(()=>{e.classList.remove("temp-no-animation")},1e3)},D=()=>{const f=g-i;Math.abs(f)>40&&Math.abs(f)>Math.abs(w-p)&&(f<0?v((a+1)%n.length):v((a-1+n.length)%n.length),m())},y=()=>{A(),o=setInterval(()=>{v((a+1)%n.length)},h)},A=()=>{o!==null&&(clearInterval(o),o=null)},m=()=>{d||(d=!0,u&&t&&y()),u&&!t&&y()};l.forEach((s,f)=>{s.addEventListener("click",()=>{v(f),m()})}),r==null||r.addEventListener("click",()=>{console.log("prev slide"),v((a-1+n.length)%n.length),m()}),c==null||c.addEventListener("click",()=>{console.log("next slide"),v((a+1)%n.length),m()}),e.addEventListener("mouseenter",A),e.addEventListener("mouseleave",()=>{u&&(!t||d)&&y()}),e.addEventListener("focusin",A),e.addEventListener("focusout",()=>{u&&(!t||d)&&y()}),e.addEventListener("keydown",s=>{s.key==="ArrowLeft"?(s.preventDefault(),v((a-1+n.length)%n.length),m()):s.key==="ArrowRight"&&(s.preventDefault(),v((a+1)%n.length),m())}),e.addEventListener("touchstart",s=>{i=s.changedTouches[0].screenX,p=s.changedTouches[0].screenY},{passive:!0}),e.addEventListener("touchend",s=>{g=s.changedTouches[0].screenX,w=s.changedTouches[0].screenY,Math.abs(w-p)<M&&D()},{passive:!0}),n.length>1&&u&&!t&&y();const k={goToSlide:(s,f=!1)=>v(s,f),getCurrentIndex:()=>a,goToNextSlide:()=>v((a+1)%n.length),goToPreviousSlide:()=>v((a-1+n.length)%n.length),pause:A,resume:y};T.set(e,k),e._carouselController=k})});document.addEventListener("DOMContentLoaded",()=>{const e={};function n(t,a=0){console.log("openModal",t,"slideTo",a);const d=document.querySelector(t);if(!d)return console.warn("Modal not found:",t);d.classList.add("active"),d.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",O(d);const o=d.querySelector("[data-carousel]"),i=I(o);i&&i.goToSlide(parseInt(a),!0),S("modalOpened",d)}function l(t){t.classList.remove("active"),t.setAttribute("aria-hidden","true"),document.body.style.overflow="",q(t),S("modalClosed",t)}document.addEventListener("click",t=>{const a=t.target;console.log("target",a);const d=t.target.closest("[data-modal-trigger]");if(d){console.log("found trigger",d),t.preventDefault(),n(d.getAttribute("data-modal-trigger"),d.getAttribute("data-slide-to")||0);return}const o=t.target.closest("[data-modal-close]");if(o){const g=o.closest("[data-modal]");g&&l(g);return}const i=t.target.closest("[data-modal]");i&&t.target===i&&l(i)}),document.addEventListener("keydown",t=>{t.key==="Escape"&&document.querySelectorAll("[data-modal].active").forEach(l)});function r(t){const a=t.querySelector("[data-carousel]"),d=t.hasAttribute("data-video-autoplay");t.addEventListener("liteYoutubeIframeLoaded",o=>{const i=o.target.closest("[data-youtube-video-id]");if(!i)return;const g=i.getAttribute("data-youtube-video-id"),p=i.querySelector("lite-youtube").shadowRoot.querySelector("iframe");e[g]=new YT.Player(p,{events:{onReady:()=>{}}})}),t.addEventListener("modalOpened",()=>{if(!d)return;const o=t.querySelector(".media-carousel-item.active");if(!o)return;const i=o.querySelector(".media-video-container[data-youtube-video-id]");i&&h(i.getAttribute("data-youtube-video-id"))}),t.addEventListener("modalClosed",c),t.addEventListener("keydown",o=>{if(!t.classList.contains("active"))return;const i=t.querySelector("[data-carousel]");if(!i)return;const g=I(i);if(!g)return;const p=i.contains(o.target);if(o.key==="Escape"){l(t),o.stopPropagation(),o.preventDefault();return}(o.key==="ArrowLeft"||o.key==="ArrowRight")&&p||(o.key==="ArrowLeft"?(o.preventDefault(),o.stopPropagation(),g.goToPreviousSlide()):o.key==="ArrowRight"&&(o.preventDefault(),o.stopPropagation(),g.goToNextSlide()))}),document.addEventListener("onImageUpdated",o=>{console.log("✅ Global listener got event:",o.detail)}),t.addEventListener("onImageUpdated",o=>{console.log("onImageUpdated",o)}),a&&a.addEventListener("carouselSlided",()=>{if(u(),!d)return;const o=a.querySelector(".media-carousel-item.active");if(!o)return;const i=o.querySelector(".media-video-container[data-youtube-video-id]");i&&h(i.getAttribute("data-youtube-video-id"))})}function c(){Object.values(e).forEach(t=>t.stopVideo())}function u(){Object.values(e).forEach(t=>t.pauseVideo())}function h(t){const a=e[t];a&&a.playVideo()}document.querySelectorAll("[data-modal]").forEach(r)});document.addEventListener("DOMContentLoaded",()=>{function e(r){console.log("setupModal",r),r.addEventListener("modalOpened",()=>{}),document.addEventListener("onImageUpdated",c=>{console.log("✅ Global listener got event:",c.detail)}),r.addEventListener("onImageUpdated",c=>{console.log("onImageUpdated",c)}),r.addEventListener("onImageUpdated",c=>{console.log("onImageUpdated",c),n(r)})}function n(r){r.classList.remove("active"),r.setAttribute("aria-hidden","true"),document.body.style.overflow="",q(r),S("modalClosed",r)}const l=document.querySelectorAll("[data-image-editor-modal]");l.forEach(e),console.log("modals",l)});

import{h as c}from"./xhrStatus.js";import{g as m}from"./media-manager-config.js";async function p(r,d,o,a={}){const e=r.querySelector("[data-media-manager-lab-previews]");if(!e)return;const s=new URLSearchParams({initiator_id:d.id,medium_id:o});s.append("_",Date.now()),a.part&&s.append("part",a.part);try{const t=await fetch(`${d.mediaManagerLabPreviewUpdateRoute}?${s}`,{headers:{Accept:"application/json"},cache:"no-store"}),i=await t.json();if(!t.ok){c(t,i);return}if(!i.html)return;if(a.part==="original"){const n=e.querySelector("[data-media-lab-preview-original]");n&&(n.outerHTML=i.html)}else if(a.part==="base"){const n=e.querySelector("[data-media-lab-preview-base]");n&&(n.outerHTML=i.html)}else e.innerHTML=i.html;document.dispatchEvent(new CustomEvent("mediaManagerLabPreviewsUpdated",{bubbles:!1,detail:{mediaManager:r,previewsContainer:e}}))}catch(t){console.error("Error refreshing media manager:",t)}}document.addEventListener("imageUpdated",r=>{const o=document.getElementById(r.detail.initiatorId).closest("[data-media-manager-lab]"),a=r.detail.mediumId,e=m(o);if(!e){console.warn("Could not get config");return}p(o,e,a,{part:"original"})});export{p as u};

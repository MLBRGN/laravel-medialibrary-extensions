window.mleFilePicker=(o,u,a)=>{if(a.filetype==="image"){let r=function(l){if(!l.data||!l.data.mce)return;const e=l.data.content;if(!e){console.warn("No file");return}if(a.filetype==="image"){const i=new Image;i.src=e.url,i.onload=()=>{const c=i.naturalWidth,g=i.naturalHeight,p={alt:e.alt||"",classes:"",width:c+"px",height:g+"px",vspace:e.vspace||"0px",hspace:e.hspace||"0px",border:e.border||"0px",borderstyle:e.borderstyle||"none"};o(e.url,p)},i.onerror=()=>{console.warn("Could not load image for dimensions"),o(e.url,{alt:e.alt||""})}}else a.filetype==="media"?o(e.url,{source2:e.source2||"",poster:e.poster||""}):a.filetype==="file"&&o(e.url,{text:e.name||"",title:e.title||""});window.removeEventListener("message",r),m.close()};var w=r;const t=tinymce.activeEditor.getElement(),n=t.getAttribute("data-mle-model-id")==="";console.log("temporaryUploadMode",n);const s={initiator_id:t.getAttribute("data-mle-initiator-id"),model_type:t.getAttribute("data-mle-model-type")??"",model_id:t.getAttribute("data-mle-model-id"),media_manager_id:"myMediaManager",collections:JSON.stringify({image:t.getAttribute("data-mle-image-collection"),video:t.getAttribute("data-mle-video-collection"),audio:t.getAttribute("data-mle-audio-collection")}),temporary_upload_mode:n,options:JSON.stringify({temporaryUploadMode:n,frontendTheme:"plain"})},d=new URL("/mlbrgn-mle/media-manager-tinymce",window.location.origin);d.search=new URLSearchParams(s).toString();const m=tinymce.activeEditor.windowManager.openUrl({title:"Select images",url:d.toString(),buttons:[{type:"cancel",text:"Close"}]});window.addEventListener("message",r)}};window.addEventListener("message",o=>{console.log("RAW postMessage seen by parent:",o)});

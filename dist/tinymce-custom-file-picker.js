window.mleFilePicker=(t,m,c)=>{if(c.filetype==="image"){let o=function(a){var l;if(!a.data||!a.data.mce)return;const e=a.data;console.log("Fallback message received:",e),Array.isArray(e.content)?e.content.forEach(r=>{t(r.url,{alt:r.alt||""})}):(l=e.content)!=null&&l.url&&t(e.content.url,{alt:e.content.alt||""}),window.removeEventListener("message",o),s.close()};var g=o;const i=tinymce.activeEditor.getElement(),d={initiator_id:i.getAttribute("data-initiator-id"),model_type:i.getAttribute("data-model-type"),model_id:i.getAttribute("data-model-id"),media_manager_id:"myMediaManager",image_collection:"image-collection",video_collection:"video-collection",audio_collection:"audio-collection"},n=new URL("/mlbrgn-mle/media-manager-tinymce",window.location.origin);n.search=new URLSearchParams(d).toString();const s=tinymce.activeEditor.windowManager.openUrl({title:"Select images",url:n.toString(),buttons:[{type:"cancel",text:"Close"}]});window.addEventListener("message",o)}};window.addEventListener("message",t=>{console.log("RAW postMessage seen by parent:",t)});

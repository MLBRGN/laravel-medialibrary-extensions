window.mleFilePicker=(o,u,a)=>{if(a.filetype==="image"){let r=function(d){if(!d.data||!d.data.mce)return;const e=d.data.content;if(!e){console.warn("No file");return}if(a.filetype==="image"){const i=new Image;i.src=e.url,i.onload=()=>{const m=i.naturalWidth,g=i.naturalHeight,p={alt:e.alt||"",classes:"",width:m+"px",height:g+"px",vspace:e.vspace||"0px",hspace:e.hspace||"0px",border:e.border||"0px",borderstyle:e.borderstyle||"none"};o(e.url,p)},i.onerror=()=>{console.warn("Could not load image for dimensions"),o(e.url,{alt:e.alt||""})}}else a.filetype==="media"?o(e.url,{source2:e.source2||"",poster:e.poster||""}):a.filetype==="file"&&o(e.url,{text:e.name||"",title:e.title||""});window.removeEventListener("message",r),c.close()};var w=r;const t=tinymce.activeEditor.getElement(),n=t.getAttribute("data-model-id")==="";console.log("temporaryUploadMode",n);const s={initiator_id:t.getAttribute("data-initiator-id"),model_type:t.getAttribute("data-model-type")??"",model_id:t.getAttribute("data-model-id"),media_manager_id:"myMediaManager",collections:JSON.stringify({image:t.getAttribute("data-image-collection"),video:t.getAttribute("data-video-collection"),audio:t.getAttribute("data-audio-collection")}),temporary_upload_mode:n,options:JSON.stringify({temporaryUploadMode:n,frontendTheme:"plain"})},l=new URL("/mlbrgn-mle/media-manager-tinymce",window.location.origin);l.search=new URLSearchParams(s).toString();const c=tinymce.activeEditor.windowManager.openUrl({title:"Select images",url:l.toString(),buttons:[{type:"cancel",text:"Close"}]});window.addEventListener("message",r)}};window.addEventListener("message",o=>{console.log("RAW postMessage seen by parent:",o)});

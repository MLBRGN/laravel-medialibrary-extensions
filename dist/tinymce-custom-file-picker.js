window.mleFilePicker=(t,p,a)=>{if(a.filetype==="image"){let n=function(r){if(!r.data||!r.data.mce)return;const e=r.data.content;if(!e){console.warn("No file");return}if(a.filetype==="image"){const o=new Image;o.src=e.url,o.onload=()=>{const c=o.naturalWidth,m=o.naturalHeight,g={alt:e.alt||"",classes:"",width:c+"px",height:m+"px",vspace:e.vspace||"0px",hspace:e.hspace||"0px",border:e.border||"0px",borderstyle:e.borderstyle||"none"};t(e.url,g)},o.onerror=()=>{console.warn("Could not load image for dimensions"),t(e.url,{alt:e.alt||""})}}else a.filetype==="media"?t(e.url,{source2:e.source2||"",poster:e.poster||""}):a.filetype==="file"&&t(e.url,{text:e.name||"",title:e.title||""});window.removeEventListener("message",n),s.close()};var u=n;const i=tinymce.activeEditor.getElement(),d={initiator_id:i.getAttribute("data-initiator-id"),model_type:i.getAttribute("data-model-type"),model_id:i.getAttribute("data-model-id"),media_manager_id:"myMediaManager",collections:JSON.stringify({image:i.getAttribute("data-image-collection"),video:i.getAttribute("data-video-collection"),audio:i.getAttribute("data-audio-collection")}),temporary_upload_mode:!1,options:JSON.stringify({temporaryUploadMode:!1,frontendTheme:"plain"})},l=new URL("/mlbrgn-mle/media-manager-tinymce",window.location.origin);l.search=new URLSearchParams(d).toString();const s=tinymce.activeEditor.windowManager.openUrl({title:"Select images",url:l.toString(),buttons:[{type:"cancel",text:"Close"}]});window.addEventListener("message",n)}};window.addEventListener("message",t=>{console.log("RAW postMessage seen by parent:",t)});

window.mleFilePicker=(t,u,i)=>{if(i.filetype==="image"){let a=function(l){if(!l.data||!l.data.mce)return;const e=l.data.content;if(!e){console.warn("No file");return}if(console.log("just before callback"),console.log("file",e),i.filetype==="image"){console.log("image",e);const o=new Image;o.src=e.url,o.onload=()=>{const g=o.naturalWidth,m=o.naturalHeight,c={alt:e.alt||"",classes:"",width:g+"px",height:m+"px",vspace:e.vspace||"0px",hspace:e.hspace||"0px",border:e.border||"0px",borderstyle:e.borderstyle||"none"};console.log("data",c),t(e.url,c)},o.onerror=()=>{console.warn("Could not load image for dimensions"),t(e.url,{alt:e.alt||""})}}else i.filetype==="media"?t(e.url,{source2:e.source2||"",poster:e.poster||""}):i.filetype==="file"&&t(e.url,{text:e.name||"",title:e.title||""});window.removeEventListener("message",a),d.close()};var p=a;const n=tinymce.activeEditor.getElement(),r={initiator_id:n.getAttribute("data-initiator-id"),model_type:n.getAttribute("data-model-type"),model_id:n.getAttribute("data-model-id"),media_manager_id:"myMediaManager",image_collection:"image-collection",video_collection:"video-collection",audio_collection:"audio-collection"};console.log(r);const s=new URL("/mlbrgn-mle/media-manager-tinymce",window.location.origin);s.search=new URLSearchParams(r).toString();const d=tinymce.activeEditor.windowManager.openUrl({title:"Select images",url:s.toString(),buttons:[{type:"cancel",text:"Close"}]});window.addEventListener("message",a)}};window.addEventListener("message",t=>{console.log("RAW postMessage seen by parent:",t)});

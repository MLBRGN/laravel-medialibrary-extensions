import"./image-editor-listener.js";import{a as g}from"./index.es.js";import"./xhrStatus.js";document.addEventListener("DOMContentLoaded",()=>{const a=document.querySelectorAll(".media-modal"),e={};a.forEach(t=>{const o=t.querySelector(".media-carousel");let l=t.hasAttribute("data-video-autoplay");function f(i){const r=i.getAttribute("data-youtube-video-id"),n=i.querySelector("lite-youtube").shadowRoot.querySelector("iframe");e[r]=new YT.Player(n,{events:{onReady:()=>{l&&d(r)}}})}t.addEventListener("liteYoutubeIframeLoaded",i=>{const r=i.target.closest("[data-youtube-video-id]");r&&f(r)}),t.addEventListener("hidden.bs.modal",()=>{s()}),o.addEventListener("slide.bs.carousel",i=>{if(u(),t.hasAttribute("data-video-autoplay")){const r=i.relatedTarget.querySelector(".media-video-container");if(r&&r.hasAttribute("data-youtube-video-id")){let n=r.getAttribute("data-youtube-video-id");d(n)}}}),t.addEventListener("keydown",i=>{if(!t.classList.contains("show"))return;const r=t.querySelector(".media-carousel");if(!o)return;const n=bootstrap.Carousel.getInstance(r);if(!n)return;const c=o.contains(i.target);console.log(c),!((i.key==="ArrowLeft"||i.key==="ArrowRight")&&c)&&(i.key==="ArrowLeft"?(i.preventDefault(),i.stopPropagation(),n.prev()):i.key==="ArrowRight"&&(i.preventDefault(),i.stopPropagation(),n.next()))})});function s(){Object.values(e).forEach(t=>{t.stopVideo()})}function u(){Object.values(e).forEach(t=>{t.pauseVideo()})}function d(t){let o=e[t];o&&o.playVideo()}});function y(a){const e=a.imageEditorInstance,s=e.getAttribute("data-initiator-id"),u=e.getAttribute("data-medium-display-name"),d=e.getAttribute("data-medium-path");e.setImage(u,d,s),e.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:["16:9","4:3"],selectionAspectRatio:"16:9"})}function m(a){if(a.dataset.imageEditorInitialized)return;const e=a.querySelector("#image-editor-placeholder");a.addEventListener("show.bs.modal",function(){const s=JSON.parse(a.querySelector(".image-editor-modal-config").value),u=a.getAttribute("data-medium-path"),d=a.getAttribute("data-medium-display-name"),t=s.initiator_id,o=document.createElement("image-editor");o.setAttribute("id","my-image-editor"),o.setAttribute("data-medium-display-name",d),o.setAttribute("data-medium-path",u),o.setAttribute("data-initiator-id",t),o.addEventListener("imageEditorReady",l=>{y(l.detail)}),e.appendChild(o)}),a.addEventListener("hidden.bs.modal",function(){e.innerHTML=""}),a.dataset.imageEditorInitialized="true"}document.addEventListener("initializeImageEditorModal",a=>{const e=a.detail.modal;console.log("initializeImageEditorModal",e),m(e)});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-image-editor-modal]").forEach(m)});g.translationsPath="/js/vendor/image-editor/lang";

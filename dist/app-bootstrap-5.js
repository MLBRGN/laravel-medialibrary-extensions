import"./image-editor-listener.js";import{a as A}from"./index.es.js";import"./xhrStatus.js";document.addEventListener("DOMContentLoaded",()=>{let n={};const m=function(t){if(t.dataset.imageEditorInitialized)return;const o=t.querySelector(".media-carousel");t.hasAttribute("data-video-autoplay");const s=t.id;function y(e){const i=e.getAttribute("data-youtube-video-id"),a=s+"-"+i,r=e.querySelector("lite-youtube").shadowRoot.querySelector("iframe");n[a]=new YT.Player(r,{events:{onReady:()=>{n[a].isReady=!0}}})}t.addEventListener("liteYoutubeIframeLoaded",e=>{const i=e.target.closest("[data-youtube-video-id]");i&&y(i)}),t.addEventListener("shown.bs.modal",e=>{if(!t.hasAttribute("data-video-autoplay"))return;const a=e.relatedTarget.querySelector("[data-bs-slide-to]");if(a&&a.getAttribute("data-bs-slide-to")==="0"){const g=o.querySelector(".carousel-item .media-video-container").getAttribute("data-youtube-video-id"),f=s+"-"+g;v(f)}}),t.addEventListener("hidden.bs.modal",()=>{const e=t.querySelector(".media-carousel");if(!e)return;const i=bootstrap.Carousel.getInstance(e);i&&(h(),o.removeEventListener("slide.bs.carousel",l),i.to(0),o.addEventListener("slide.bs.carousel",l))});const l=e=>{if(E(),t.hasAttribute("data-video-autoplay")){const i=e.relatedTarget.querySelector(".media-video-container");if(i&&i.hasAttribute("data-youtube-video-id")){let a=i.getAttribute("data-youtube-video-id");const r=s+"-"+a;v(r)}}};o.addEventListener("slide.bs.carousel",l),t.addEventListener("keydown",e=>{if(!t.classList.contains("show"))return;const i=t.querySelector(".media-carousel");if(!i)return;const a=bootstrap.Carousel.getInstance(i);if(!a)return;const r=o.contains(e.target);(e.key==="ArrowLeft"||e.key==="ArrowRight")&&r||(e.key==="ArrowLeft"?(e.preventDefault(),e.stopPropagation(),a.prev()):e.key==="ArrowRight"&&(e.preventDefault(),e.stopPropagation(),a.next()))}),t.dataset.imageEditorInitialized="true";function c(e,i="playVideo",a=0,r=10,b=200){const g={playVideo:"playVideo",pauseVideo:"pauseVideo",stopVideo:"stopVideo"},f=g[i];if(!g[i]){console.warn(`Unknown action: ${i}`);return}const u=n[e];if(!u||!u.isReady){console.log("No player, or player not ready yet",e,"player",u,"playerIsReady",u==null?void 0:u.isReady),a<r&&setTimeout(()=>c(e,i,a+1,r,b*1.2),b);return}f&&u[f]()}function d(e,i=0,a=10,r=200){c(e,"pauseVideo",i,a,r)}function p(e,i=0,a=10,r=200){c(e,"stopVideo",i,a,r)}function v(e,i=0,a=10,r=200){console.log("startVideoPlayBack",e,i,a,r),c(e,"playVideo",i,a,r)}function E(){Object.keys(n).forEach(e=>d(e,0,10,200))}function h(){Object.keys(n).forEach(e=>p(e,0,10,200))}};document.addEventListener("mediaManagerPreviewsUpdated",t=>{n={};const o=t.detail.mediaManager;console.log("reinitialize modals for media manager",o),o.querySelectorAll(".media-modal").forEach(m)}),document.querySelectorAll(".media-modal").forEach(m)});document.addEventListener("DOMContentLoaded",()=>{function n(t){const o=t.imageEditorInstance,s=o.getAttribute("data-initiator-id"),y=o.getAttribute("data-medium-display-name"),l=o.getAttribute("data-medium-path");o.setImage(y,l,s),o.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:["16:9","4:3"],selectionAspectRatio:"16:9"})}function m(t){if(t.dataset.imageEditorInitialized)return;const o=t.querySelector("[data-image-editor-placeholder]");t.addEventListener("show.bs.modal",function(){const s=JSON.parse(t.querySelector(".image-editor-modal-config").value),y=t.getAttribute("data-medium-path"),l=t.getAttribute("data-medium-display-name"),c=s.initiator_id,d=document.createElement("image-editor");d.setAttribute("id","my-image-editor"),d.setAttribute("data-medium-display-name",l),d.setAttribute("data-medium-path",y),d.setAttribute("data-initiator-id",c),d.addEventListener("imageEditorReady",p=>{n(p.detail)}),o.appendChild(d)}),t.addEventListener("hidden.bs.modal",function(){o.innerHTML=""}),t.dataset.imageEditorInitialized="true"}document.addEventListener("mediaManagerPreviewsUpdated",t=>{const o=t.detail.mediaManager;o.querySelectorAll("[data-image-editor-modal]").forEach(m),console.log("reinitialize image editor modals for media manager",o)}),document.querySelectorAll("[data-image-editor-modal]").forEach(m)});A.translationsPath="/js/vendor/image-editor/lang";

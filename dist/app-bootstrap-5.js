import"./image-editor-listener.js";import"./index.es.js";document.addEventListener("DOMContentLoaded",()=>{const c=document.querySelectorAll(".media-modal"),u={};c.forEach(e=>{const n=e.querySelector(".media-carousel");let l=e.hasAttribute("data-video-autoplay");function d(t){const i=t.getAttribute("data-youtube-video-id"),s=t.querySelector("lite-youtube").shadowRoot.querySelector("iframe");u[i]=new YT.Player(s,{events:{onReady:()=>{l&&r(i)}}})}e.addEventListener("liteYoutubeIframeLoaded",t=>{const i=t.target.closest("[data-youtube-video-id]");i&&d(i)}),e.addEventListener("hidden.bs.modal",()=>{a()}),n.addEventListener("slide.bs.carousel",t=>{if(o(),e.hasAttribute("data-video-autoplay")){const i=t.relatedTarget.querySelector(".media-video-container");if(i&&i.hasAttribute("data-youtube-video-id")){let s=i.getAttribute("data-youtube-video-id");r(s)}}}),e.addEventListener("keydown",t=>{if(!e.classList.contains("show"))return;const i=e.querySelector(".media-carousel");if(!n)return;const s=bootstrap.Carousel.getInstance(i);if(!s)return;const m=n.contains(t.target);console.log(m),!((t.key==="ArrowLeft"||t.key==="ArrowRight")&&m)&&(t.key==="ArrowLeft"?(t.preventDefault(),t.stopPropagation(),s.prev()):t.key==="ArrowRight"&&(t.preventDefault(),t.stopPropagation(),s.next()))})});function a(){Object.values(u).forEach(e=>{e.stopVideo()})}function o(){Object.values(u).forEach(e=>{e.pauseVideo()})}function r(e){let n=u[e];n&&n.playVideo()}});document.addEventListener("DOMContentLoaded",()=>{const c=document.querySelectorAll("[data-image-editor-modal]"),u=function(a){console.log("initializeImageEditor:",a);const o=a.imageEditorInstance,r=o.getAttribute("data-initiator-id"),e=o.getAttribute("data-medium-display-name"),n=o.getAttribute("data-medium-path");o.setImage(e,n,r),o.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:["16:9","4:3"],selectionAspectRatio:"16:9"})};c.forEach(a=>{const o=a.querySelector("#image-editor-placeholder");a.addEventListener("show.bs.modal",function(){const r=JSON.parse(a.querySelector(".image-editor-modal-config").value),e=a.getAttribute("data-medium-path"),n=a.getAttribute("data-medium-display-name"),l=r.initiator_id,d=document.createElement("image-editor");d.setAttribute("id","my-image-editor"),d.setAttribute("data-medium-display-name",n),d.setAttribute("data-medium-path",e),d.setAttribute("data-initiator-id",l),d.addEventListener("imageEditorReady",t=>{console.log("Image editor is ready:",t),u(t.detail)}),o.appendChild(d)}),a.addEventListener("hidden.bs.modal",function(){a.querySelector("image-editor"),o.innerHTML=""}),a.addEventListener("onImageUpdated",r=>{console.log("onImageUpdated",r),bootstrap.Modal.getInstance(a).hide()})})});

import"./image-editor-listener.js";import{a as E}from"./index.es.js";import"./xhrStatus.js";document.addEventListener("DOMContentLoaded",()=>{let u={};const f=function(e){if(e.dataset.imageEditorInitialized)return;const i=e.querySelector(".media-carousel");e.hasAttribute("data-video-autoplay");const d=e.id;function s(t){const a=t.getAttribute("data-youtube-video-id"),r=d+"-"+a,m=t.querySelector("lite-youtube").shadowRoot.querySelector("iframe");u[r]=new YT.Player(m,{events:{onReady:()=>{u[r].isReady=!0}}})}e.addEventListener("liteYoutubeIframeLoaded",t=>{const a=t.target.closest("[data-youtube-video-id]");a&&s(a)}),e.addEventListener("shown.bs.modal",t=>{if(!e.hasAttribute("data-video-autoplay"))return;const r=t.relatedTarget.querySelector("[data-bs-slide-to]");if(r&&r.getAttribute("data-bs-slide-to")==="0"){const b=i.querySelector(".carousel-item .media-video-container").getAttribute("data-youtube-video-id"),v=d+"-"+b;c(v)}}),e.addEventListener("hidden.bs.modal",()=>{const t=e.querySelector(".media-carousel");if(!t)return;const a=bootstrap.Carousel.getInstance(t);a&&(p(),i.removeEventListener("slide.bs.carousel",l),a.to(0),i.addEventListener("slide.bs.carousel",l))});const l=t=>{if(y(),e.hasAttribute("data-video-autoplay")){const a=t.relatedTarget.querySelector(".media-video-container");if(a&&a.hasAttribute("data-youtube-video-id")){let r=a.getAttribute("data-youtube-video-id");const m=d+"-"+r;c(m)}}};i.addEventListener("slide.bs.carousel",l),e.addEventListener("keydown",t=>{if(!e.classList.contains("show"))return;const a=e.querySelector(".media-carousel");if(!a)return;const r=bootstrap.Carousel.getInstance(a);if(!r)return;const m=i.contains(t.target);(t.key==="ArrowLeft"||t.key==="ArrowRight")&&m||(t.key==="ArrowLeft"?(t.preventDefault(),t.stopPropagation(),r.prev()):t.key==="ArrowRight"&&(t.preventDefault(),t.stopPropagation(),r.next()))}),e.dataset.imageEditorInitialized="true"};function o(e,i="playVideo",d=0,s=10,l=200){const t={playVideo:"playVideo",pauseVideo:"pauseVideo",stopVideo:"stopVideo"},a=t[i];if(!t[i]){console.warn(`Unknown action: ${i}`);return}const r=u[e];if(!r||!r.isReady){d<s&&setTimeout(()=>o(e,i,d+1,s,l*1.2),l);return}a&&r[a]()}function n(e,i=0,d=10,s=200){o(e,"pauseVideo",i,d,s)}function g(e,i=0,d=10,s=200){o(e,"stopVideo",i,d,s)}function c(e,i=0,d=10,s=200){o(e,"playVideo",i,d,s)}function y(){Object.keys(u).forEach(e=>n(e,0,10,200))}function p(){Object.keys(u).forEach(e=>g(e,0,10,200))}document.addEventListener("mediaManagerPreviewsUpdated",e=>{u={};const i=e.detail.mediaManager;console.log("reinitialize modals for media manager",i),i.querySelectorAll(".media-modal").forEach(f)}),document.querySelectorAll(".media-modal").forEach(f)});document.addEventListener("DOMContentLoaded",()=>{function u(o){const n=o.imageEditorInstance,g=n.getAttribute("data-initiator-id"),c=n.getAttribute("data-medium-display-name"),y=n.getAttribute("data-medium-path");n.setImage(c,y,g),n.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:["16:9","4:3"],selectionAspectRatio:"16:9"})}function f(o){if(o.dataset.imageEditorInitialized)return;const n=o.querySelector("[data-image-editor-placeholder]");o.addEventListener("show.bs.modal",function(){const g=JSON.parse(o.querySelector(".image-editor-modal-config").value),c=o.getAttribute("data-medium-path"),y=o.getAttribute("data-medium-display-name"),p=g.initiator_id,e=document.createElement("image-editor");e.setAttribute("id","my-image-editor"),e.setAttribute("data-medium-display-name",y),e.setAttribute("data-medium-path",c),e.setAttribute("data-initiator-id",p),e.addEventListener("imageEditorReady",i=>{u(i.detail)}),n.appendChild(e)}),o.addEventListener("hidden.bs.modal",function(){n.innerHTML=""}),o.dataset.imageEditorInitialized="true"}document.addEventListener("mediaManagerPreviewsUpdated",o=>{const n=o.detail.mediaManager;n.querySelectorAll("[data-image-editor-modal]").forEach(f),console.log("reinitialize image editor modals for media manager",n)}),document.querySelectorAll("[data-image-editor-modal]").forEach(f)});E.translationsPath="/js/vendor/image-editor/lang";

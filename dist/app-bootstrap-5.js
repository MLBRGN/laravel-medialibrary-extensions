import{b as g}from"./image-editor-listener.js";import"./index.es.js";document.addEventListener("DOMContentLoaded",()=>{const d=document.querySelectorAll(".media-modal"),o={};d.forEach(t=>{const n=t.querySelector(".media-carousel");let i=t.hasAttribute("data-video-autoplay");function u(e){const a=e.getAttribute("data-youtube-video-id"),r=e.querySelector("lite-youtube").shadowRoot.querySelector("iframe");o[a]=new YT.Player(r,{events:{onReady:()=>{i&&c(a)}}})}t.addEventListener("liteYoutubeIframeLoaded",e=>{const a=e.target.closest("[data-youtube-video-id]");a&&u(a)}),t.addEventListener("hidden.bs.modal",()=>{s()}),n.addEventListener("slide.bs.carousel",e=>{if(l(),t.hasAttribute("data-video-autoplay")){const a=e.relatedTarget.querySelector(".media-video-container");if(a&&a.hasAttribute("data-youtube-video-id")){let r=a.getAttribute("data-youtube-video-id");c(r)}}}),t.addEventListener("keydown",e=>{if(!t.classList.contains("show"))return;const a=t.querySelector(".media-carousel");if(!n)return;const r=bootstrap.Carousel.getInstance(a);if(!r)return;const m=n.contains(e.target);console.log(m),!((e.key==="ArrowLeft"||e.key==="ArrowRight")&&m)&&(e.key==="ArrowLeft"?(e.preventDefault(),e.stopPropagation(),r.prev()):e.key==="ArrowRight"&&(e.preventDefault(),e.stopPropagation(),r.next()))})});function s(){Object.values(o).forEach(t=>{t.stopVideo()})}function l(){Object.values(o).forEach(t=>{t.pauseVideo()})}function c(t){let n=o[t];n&&n.playVideo()}});console.log("just before EventBus registering");g.register("onImageSave",d=>{console.log(d)});g.register("onCanvasStatusMessage",d=>{console.log("onCanvasStatusMessage using event bus",d.detail)});g.register("onCloseImageEditor",d=>{console.log("onCloseImageEditor using event bus",d.detail)});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-image-editor-modal]").forEach(o=>{o.addEventListener("show.bs.modal",function(){console.log("Image editor shown");const s=o.querySelector("#image-editor-placeholder"),l=JSON.parse(o.querySelector(".image-editor-modal-config").value);console.log("config",l);const c=o.getAttribute("data-medium-path"),t=o.getAttribute("data-medium-display-name"),n=l.initiator_id,i=document.createElement("image-editor");i.setAttribute("id","my-image-editor"),i.setAttribute("data-medium-display-name",t),i.setAttribute("data-medium-path",c),i.setAttribute("data-initiator-id",n),i.addEventListener("imageEditorReady",e=>{console.log("Caught event editor.addE...:",e.detail)}),i.shadowRoot.addEventListener("imageEditorReady",e=>{console.log("Caught event editor.shadowRoot.addE..:",e.detail)}),s.appendChild(i);const u=document.querySelector("#my-image-editor");console.log("testImageEditor",u),u.addEventListener("imageEditorReady",e=>{console.log("Caught event: testImageEditor.addE...",e.detail)}),u.shadowRoot.addEventListener("imageEditorReady",e=>{console.log("Caught event: testImageEditor.shadowRoot.addE...",e.detail)})}),o.addEventListener("imageEditorReady",s=>{console.log("Image editor editor ready!!!!!!")}),o.addEventListener("hidden.bs.modal",function(){console.log("image editor hidden")}),o.addEventListener("onImageUpdated",s=>{console.log("onImageUpdated",s),bootstrap.Modal.getInstance(o).hide()})})});

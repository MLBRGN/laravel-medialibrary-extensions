import"./image-editor-listener.js";import{a as A}from"./index.es.js";import"./xhrStatus.js";document.addEventListener("DOMContentLoaded",()=>{let d={};const g=function(o){if(o.dataset.imageEditorInitialized)return;const a=o.querySelector(".media-carousel");o.hasAttribute("data-video-autoplay");const r=o.id;function m(e){const t=e.getAttribute("data-youtube-video-id"),i=r+"-"+t,n=e.querySelector("lite-youtube").shadowRoot.querySelector("iframe");d[i]=new YT.Player(n,{events:{onReady:()=>{d[i].isReady=!0}}})}o.addEventListener("liteYoutubeIframeLoaded",e=>{const t=e.target.closest("[data-youtube-video-id]");t&&m(t)}),o.addEventListener("shown.bs.modal",e=>{if(!o.hasAttribute("data-video-autoplay"))return;const i=e.relatedTarget.querySelector("[data-bs-slide-to]");if(i&&i.getAttribute("data-bs-slide-to")==="0"){const f=a.querySelector(".carousel-item .media-video-container").getAttribute("data-youtube-video-id"),p=r+"-"+f;y(p)}}),o.addEventListener("hidden.bs.modal",()=>{const e=o.querySelector(".media-carousel");if(!e)return;const t=bootstrap.Carousel.getInstance(e);t&&(h(),a.removeEventListener("slide.bs.carousel",c),t.to(0),a.addEventListener("slide.bs.carousel",c))});const c=e=>{if(v(),o.hasAttribute("data-video-autoplay")){const t=e.relatedTarget.querySelector(".media-video-container");if(t&&t.hasAttribute("data-youtube-video-id")){let i=t.getAttribute("data-youtube-video-id");const n=r+"-"+i;y(n)}}};a.addEventListener("slide.bs.carousel",c),o.addEventListener("keydown",e=>{if(!o.classList.contains("show"))return;const t=o.querySelector(".media-carousel");if(!t)return;const i=bootstrap.Carousel.getInstance(t);if(!i)return;const n=a.contains(e.target);(e.key==="ArrowLeft"||e.key==="ArrowRight")&&n||(e.key==="ArrowLeft"?(e.preventDefault(),e.stopPropagation(),i.prev()):e.key==="ArrowRight"&&(e.preventDefault(),e.stopPropagation(),i.next()))}),o.dataset.imageEditorInitialized="true";function s(e,t="playVideo",i=0,n=10,E=200){const f={playVideo:"playVideo",pauseVideo:"pauseVideo",stopVideo:"stopVideo"},p=f[t];if(!f[t]){console.warn(`Unknown action: ${t}`);return}const u=d[e];if(!u||!u.isReady){console.log("No player, or player not ready yet",e,"player",u,"playerIsReady",u==null?void 0:u.isReady),i<n&&setTimeout(()=>s(e,t,i+1,n,E*1.2),E);return}p&&u[p]()}function b(e,t=0,i=10,n=200){s(e,"pauseVideo",t,i,n)}function l(e,t=0,i=10,n=200){s(e,"stopVideo",t,i,n)}function y(e,t=0,i=10,n=200){console.log("startVideoPlayBack",e,t,i,n),s(e,"playVideo",t,i,n)}function v(){Object.keys(d).forEach(e=>b(e,0,10,200))}function h(){Object.keys(d).forEach(e=>l(e,0,10,200))}};document.addEventListener("mediaManagerPreviewsUpdated",o=>{d={};const a=o.detail.mediaManager;console.log("reinitialize modals for media manager",a),a.querySelectorAll(".media-modal").forEach(g)}),document.querySelectorAll(".media-modal").forEach(g)});document.addEventListener("DOMContentLoaded",()=>{const d=a=>{if(typeof bootstrap>"u"||!bootstrap.Modal){console.warn("Bootstrap Modal is not available.");return}bootstrap.Modal.getInstance(a).hide()};function g(a){const r=a.imageEditorInstance,m=r.getAttribute("data-initiator-id"),c=r.getAttribute("data-medium-display-name"),s=r.getAttribute("data-medium-path");r.setImage(c,s,m),r.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:["16:9","4:3"],selectionAspectRatio:"16:9"})}function o(a){if(a.dataset.imageEditorInitialized)return;const r=a.querySelector("[data-image-editor-placeholder]");a.addEventListener("show.bs.modal",function(){const m=JSON.parse(a.querySelector(".image-editor-modal-config").value),c=a.getAttribute("data-medium-path"),s=a.getAttribute("data-medium-display-name"),b=m.initiator_id,l=document.createElement("image-editor");l.setAttribute("id","my-image-editor"),l.setAttribute("data-medium-display-name",s),l.setAttribute("data-medium-path",c),l.setAttribute("data-initiator-id",b),l.addEventListener("imageEditorReady",y=>{g(y.detail)}),r.appendChild(l)}),a.addEventListener("hidden.bs.modal",function(){r.innerHTML=""}),a.dataset.imageEditorInitialized="true"}document.addEventListener("mediaManagerPreviewsUpdated",a=>{const r=a.detail.mediaManager;r.querySelectorAll("[data-image-editor-modal]").forEach(o),console.log("reinitialize image editor modals for media manager",r)}),document.addEventListener("imageEditorModalCloseRequest",a=>{const r=a.detail.modal;console.log("imageEditorModalCloseRequest",r),d(r)}),document.querySelectorAll("[data-image-editor-modal]").forEach(o)});A.translationsPath="/js/vendor/image-editor/lang";

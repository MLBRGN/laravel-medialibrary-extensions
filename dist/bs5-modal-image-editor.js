const g=e=>{if(typeof bootstrap>"u"||!bootstrap.Modal){console.warn("Bootstrap Modal is not available.");return}bootstrap.Modal.getInstance(e).hide()};function f(e){console.log("initializeImageEditor config",e);const t=e.imageEditorInstance;if(!t){console.warn("No imageEditorInstance provided.");return}const{name:a,path:n,initiatorId:i,requiredAspectRatio:o,minDimensions:d,maxDimensions:r}=e;t.setImage(a,n,i);const l={debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:[o],selectionAspectRatio:o,minWidth:d.width,minHeight:d.height,maxWidth:r.width,maxHeight:r.height,imagePropertiesEnabled:!1,fileFormatEnabled:!1,rotationEnabled:!0,mirroringEnabled:!0,selectingEnabled:!0,croppingEnabled:!0,gridEnabled:!1,downloadingEnabled:!1,freeSelectEnabled:!1,freeRotationEnabled:!1,resizingEnabled:!1,filtersEnabled:!1,selectionInfoEnabled:!1,selectionAspectRatioEnabled:!1,helpEnabled:!1};t.setConfiguration(l)}function s(e){if(e.dataset.mleImageEditorInitialized)return;const t=e.querySelector("[data-mle-image-editor-placeholder]");e.addEventListener("show.bs.modal",function(){const a=JSON.parse(e.querySelector("[data-mle-image-editor-modal-config]").value),n=e.getAttribute("data-mle-medium-path"),i=e.getAttribute("data-mle-medium-display-name"),o=e.getAttribute("data-mle-medium-forced-aspect-ratio")??"4:3",d=c(e.getAttribute("data-mle-medium-minimal-dimensions"),{width:800,height:600}),r=c(e.getAttribute("data-mle-medium-maximal-dimensions"),{width:7040,height:3960}),l=a.initiatorId,m=document.createElement("image-editor");m.id="my-image-editor",m.addEventListener("imageEditorReady",u=>{f({imageEditorInstance:u.detail.imageEditorInstance,name:i,path:n,initiatorId:l,requiredAspectRatio:o,minDimensions:d,maxDimensions:r})},{once:!0}),t.appendChild(m)}),e.addEventListener("hidden.bs.modal",function(){t.innerHTML=""}),e.dataset.mleImageEditorInitialized="true"}function c(e,t){if(!e)return t;const[a,n]=e.split(/[x:]/).map(Number);return{width:a||t.width,height:n||t.height}}document.addEventListener("mediaManagerPreviewsUpdated",e=>{e.detail.mediaManager.querySelectorAll("[data-mle-image-editor-modal]").forEach(s)});document.addEventListener("imageEditorModalCloseRequest",e=>{const t=e.detail.modal;g(t)});const h=()=>{new MutationObserver(t=>{var a;for(const n of t)for(const i of n.addedNodes)i instanceof HTMLElement&&(i.matches("[data-mle-image-editor-modal]")&&s(i),(a=i.querySelectorAll)==null||a.call(i,"[data-mle-image-editor-modal]").forEach(s))}).observe(document.body,{childList:!0,subtree:!0})};h();document.querySelectorAll("[data-mle-image-editor-modal]").forEach(s);

const g=e=>{if(typeof bootstrap>"u"||!bootstrap.Modal){console.warn("Bootstrap Modal is not available.");return}bootstrap.Modal.getInstance(e).hide()};function h(e){console.log("initializeImageEditor config",e);const t=e.imageEditorInstance,{name:a,path:o,initiatorId:i,requiredAspectRatio:s,minDimensions:n,maxDimensions:d}=e;t.setImage(a,o,i),t.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:[s],minWidth:n.width,minHeight:n.height,maxWidth:d.width,maxHeight:d.height})}function r(e){if(e.dataset.imageEditorInitialized)return;const t=e.querySelector("[data-image-editor-placeholder]");e.addEventListener("show.bs.modal",function(){const a=JSON.parse(e.querySelector("[data-image-editor-modal-config]").value),o=e.getAttribute("data-medium-path"),i=e.getAttribute("data-medium-display-name"),s=e.getAttribute("data-medium-forced-aspect-ratio")??"16:9",n=c(e.getAttribute("data-medium-minimal-dimensions"),{width:800,height:600}),d=c(e.getAttribute("data-medium-maximal-dimensions"),{width:7040,height:3960}),l=a.initiatorId,m=document.createElement("image-editor");m.id="my-image-editor",m.addEventListener("imageEditorReady",u=>{h({imageEditorInstance:u.detail.imageEditorInstance,name:i,path:o,initiatorId:l,requiredAspectRatio:s,minDimensions:n,maxDimensions:d})}),t.appendChild(m)}),e.addEventListener("hidden.bs.modal",function(){t.innerHTML=""}),e.dataset.imageEditorInitialized="true"}function c(e,t){if(!e)return t;const[a,o]=e.split(/[x:]/).map(Number);return{width:a||t.width,height:o||t.height}}document.addEventListener("mediaManagerPreviewsUpdated",e=>{e.detail.mediaManager.querySelectorAll("[data-image-editor-modal]").forEach(r)});document.addEventListener("imageEditorModalCloseRequest",e=>{const t=e.detail.modal;g(t)});const f=()=>{new MutationObserver(t=>{var a;for(const o of t)for(const i of o.addedNodes)i instanceof HTMLElement&&(i.matches("[data-image-editor-modal]")&&r(i),(a=i.querySelectorAll)==null||a.call(i,"[data-image-editor-modal]").forEach(r))}).observe(document.body,{childList:!0,subtree:!0})};f();document.querySelectorAll("[data-image-editor-modal]").forEach(r);

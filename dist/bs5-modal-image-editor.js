const g=e=>{if(typeof bootstrap>"u"||!bootstrap.Modal){console.warn("Bootstrap Modal is not available.");return}bootstrap.Modal.getInstance(e).hide()};function f(e){console.log("initializeImageEditor config",e);const t=e.imageEditorInstance,{name:a,path:n,initiatorId:i,requiredAspectRatio:s,minDimensions:o,maxDimensions:d}=e;t.setImage(a,n,i),t.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:[s],minWidth:o.width,minHeight:o.height,maxWidth:d.width,maxHeight:d.height,imagePropertiesEnabled:!1,fileFormatEnabled:!1,rotationEnabled:!0,mirroringEnabled:!0,selectingEnabled:!0,croppingEnabled:!0,gridEnabled:!1,downloadingEnabled:!1,freeSelectEnabled:!1,freeRotationEnabled:!1,resizingEnabled:!1,filtersEnabled:!1,selectionInfoEnabled:!1,selectionAspectRatioEnabled:!1,helpEnabled:!1})}function r(e){if(e.dataset.imageEditorInitialized)return;const t=e.querySelector("[data-image-editor-placeholder]");e.addEventListener("show.bs.modal",function(){const a=JSON.parse(e.querySelector("[data-image-editor-modal-config]").value),n=e.getAttribute("data-medium-path"),i=e.getAttribute("data-medium-display-name"),s=e.getAttribute("data-medium-forced-aspect-ratio")??"16:9",o=m(e.getAttribute("data-medium-minimal-dimensions"),{width:800,height:600}),d=m(e.getAttribute("data-medium-maximal-dimensions"),{width:7040,height:3960}),c=a.initiatorId,l=document.createElement("image-editor");l.id="my-image-editor",l.addEventListener("imageEditorReady",u=>{f({imageEditorInstance:u.detail.imageEditorInstance,name:i,path:n,initiatorId:c,requiredAspectRatio:s,minDimensions:o,maxDimensions:d})}),t.appendChild(l)}),e.addEventListener("hidden.bs.modal",function(){t.innerHTML=""}),e.dataset.imageEditorInitialized="true"}function m(e,t){if(!e)return t;const[a,n]=e.split(/[x:]/).map(Number);return{width:a||t.width,height:n||t.height}}document.addEventListener("mediaManagerPreviewsUpdated",e=>{e.detail.mediaManager.querySelectorAll("[data-image-editor-modal]").forEach(r)});document.addEventListener("imageEditorModalCloseRequest",e=>{const t=e.detail.modal;g(t)});const h=()=>{new MutationObserver(t=>{var a;for(const n of t)for(const i of n.addedNodes)i instanceof HTMLElement&&(i.matches("[data-image-editor-modal]")&&r(i),(a=i.querySelectorAll)==null||a.call(i,"[data-image-editor-modal]").forEach(r))}).observe(document.body,{childList:!0,subtree:!0})};h();document.querySelectorAll("[data-image-editor-modal]").forEach(r);

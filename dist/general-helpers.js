let d=null;function v(s){const e=s.querySelector(".media-manager-config");if(!e)return console.warn("No config input found in media manager:",s),null;let o={};try{o=JSON.parse(e.value)}catch(r){return console.error(`Invalid JSON config for ${e}:`,r),null}return{initiatorId:o.id,modelType:o.model_type,modelId:o.model_id,imageCollection:o.image_collection,documentCollection:o.document_collection,youtubeCollection:o.youtube_collection,frontendTheme:o.frontend_theme,destroyEnabled:o.destroy_enabled,setAsFirstEnabled:o.set_as_first_enabled,showMediaUrl:o.show_media_url,showOrder:o.show_order,mediaUploadRoute:o.media_upload_route,previewRefreshRoute:o.preview_refresh_route,youtubeUploadRoute:o.youtube_upload_route,csrfToken:o.csrf_token}}function t(s){var e;return console.log("trans",s,"window.mlt",window.mediaLibraryTranslations),((e=window.mediaLibraryTranslations)==null?void 0:e[s])||s}function M(s,e,o=null){console.log("handleAjaxError",e),console.log(e),console.log("response.status",s.status);let r=t("upload_failed");switch(s.status){case 419:r=t("csrf_token_mismatch");break;case 401:r=t("unauthenticated");break;case 403:r=t("forbidden");break;case 404:console.log("404 detected",t),r=t("not_found"),console.log(r);break;case 422:if(e.errors&&o){for(const a in e.errors)e.errors[a].forEach(i=>{o({message:i,type:"error"})});return}r=e.message||t("validation_failed");break;case 429:r=t("too_many_requests");break;case 500:case 503:r=t("server_error");break;default:console.log("falling back to default",e.message,r),r=e.message||r}o?(console.log("showStatusCallback",r),o({message:r,type:"error"})):console.error(r)}function T(s){const e=typeof s=="string"?document.getElementById(s):s;if(!e){console.warn("refreshMediaManager: mediaManager element not found",s);return}const o=v(e);if(!o){console.warn("refreshMediaManager: failed to read config");return}const{initiatorId:r,modelType:a,modelId:i,imageCollection:c,youtubeCollection:u,documentCollection:l,destroyEnabled:f,setAsFirstEnabled:m,showMediaUrl:g,showOrder:_,frontendTheme:b,previewRefreshRoute:y}=o,h=e.querySelector(".media-manager-preview-grid");if(!h){console.warn("refreshMediaManager: preview grid not found");return}const w=new URLSearchParams({model_type:a,model_id:i,image_collection:c,youtube_collection:u,document_collection:l,initiator_id:r,destroy_enabled:f===!0||f==="true"?"true":"false",set_as_first_enabled:m===!0||m==="true"?"true":"false",show_media_url:g===!0||g==="true"?"true":"false",show_order:_===!0||_==="true"?"true":"false",frontend_theme:b});fetch(`${y}?${w}`,{headers:{Accept:"application/json"}}).then(n=>n.json()).then(n=>{console.log("response",n),h.innerHTML=n.html}).catch(n=>{console.error("Error refreshing media manager:",n)})}function S(s,e){const o=s.querySelector("[data-status-container]"),r=o==null?void 0:o.querySelector("[data-status-message]");if(!o||!r)return;const a=r.getAttribute("data-base-classes")||"",i=r.getAttribute("data-success-classes")||"",c=r.getAttribute("data-error-classes")||"";r.className=a,(e.type==="success"?i:c).split(" ").forEach(l=>{l.trim()&&r.classList.add(l.trim())}),r.textContent=e.message,o.classList.add("visible"),d&&clearTimeout(d),d=setTimeout(()=>{p(s)},5e3)}function p(s){const e=s.querySelector("[data-status-container]");e&&e.classList.remove("visible")}function C(s){p(s);const e=s.querySelector("div[data-spinner-container]");e&&e.classList.add("active")}function A(s){const e=s.querySelector("div[data-spinner-container]");e&&e.classList.remove("active")}export{v as a,S as b,A as c,M as h,T as r,C as s};

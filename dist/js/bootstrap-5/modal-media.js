import{C as v}from"../bootstrap.esm.js";let l={},u={};const g=function(r){if(r.dataset.mleImageEditorInitialized)return;const n=r.querySelector("[data-mle-carousel]"),p=r.id;function E(e){const t=e.getAttribute("data-mle-youtube-video-id"),a=p+"-"+t,o=e.querySelector("lite-youtube").shadowRoot.querySelector("iframe");l[a]=new YT.Player(o,{events:{onReady:()=>{l[a].isReady=!0}}})}function m(e){const t=e.querySelector("audio"),a=e.querySelector("video");let o=null;return t&&(o=t.id,u[o]=t),a&&(o=a.id,u[o]=a),o}function f(e,t){const a=u[e];if(a)try{t==="play"?a.play():t==="pause"&&a.pause()}catch(o){console.warn(`Failed to ${t} media:`,o)}}r.addEventListener("liteYoutubeIframeLoaded",e=>{const t=e.target.closest("[data-mle-youtube-video-id]");t&&E(t)}),r.addEventListener("shown.bs.modal",e=>{if(!r.hasAttribute("data-mle-autoplay"))return;const t=e.relatedTarget;if(!t)return;const a=t.querySelector("[data-bs-slide-to]");if(!a||a.getAttribute("data-bs-slide-to")!=="0")return;const i=n.querySelector("[data-mle-carousel-item]:first-child");if(console.log("firstSlide",i),!i)return;const s=m(i);f(s,"play");const y=i.querySelector("[data-mle-youtube-video]");if(y){const d=y.getAttribute("data-mle-youtube-video-id");if(!d)return;const M=`${p}-${d}`;c(M,"playVideo")}}),r.addEventListener("hidden.bs.modal",()=>{const e=r.querySelector("[data-mle-carousel]");if(!e)return;const t=v.getInstance(e);t&&(h(),n.removeEventListener("slide.bs.carousel",b),t.to(0),n.addEventListener("slide.bs.carousel",b))});const b=e=>{if(!r.hasAttribute("data-mle-autoplay"))return;I();const t=e.relatedTarget;if(!t)return;const a=m(t);f(a,"play");const o=t.querySelector("[data-mle-youtube-video]");if(o&&o.hasAttribute("data-mle-youtube-video-id")){let i=o.getAttribute("data-mle-youtube-video-id");const s=p+"-"+i;c(s,"playVideo")}};n.addEventListener("slide.bs.carousel",b),r.addEventListener("keydown",e=>{if(!r.classList.contains("show"))return;const t=r.querySelector("[data-mle-carousel]");if(!t)return;const a=v.getInstance(t);if(!a)return;const o=n.contains(e.target);(e.key==="ArrowLeft"||e.key==="ArrowRight")&&o||(e.key==="ArrowLeft"?(e.preventDefault(),e.stopPropagation(),a.prev()):e.key==="ArrowRight"&&(e.preventDefault(),e.stopPropagation(),a.next()))}),r.dataset.mleImageEditorInitialized="true";function c(e,t="playVideo",a=0,o=10,i=200){const s={playVideo:"playVideo",pauseVideo:"pauseVideo",stopVideo:"stopVideo"},y=s[t];if(!s[t]){console.warn(`Unknown action: ${t}`);return}const d=l[e];if(!d||!d.isReady){a<o&&setTimeout(()=>c(e,t,a+1,o,i*1.2),i);return}y&&d[y]()}function I(){Object.keys(l).forEach(e=>c(e,"pauseVideo")),Object.keys(u).forEach(e=>f(e,"pause"))}function h(){console.log("stopAllMediaPlayBack"),Object.keys(l).forEach(e=>c(e,"stopVideo")),Object.keys(u).forEach(e=>f(e,"pause"))}};document.addEventListener("mediaManagerPreviewsUpdated",r=>{l={},u={},r.detail.mediaManager.querySelectorAll("[data-mle-media-modal]").forEach(g)});document.querySelectorAll("[data-mle-media-modal]").forEach(g);

import{g as u}from"./bootstrap-resolver.js";const f=e=>{u().Modal.getInstance(e).hide()};function E(e){console.log("initializeImageEditor config",e);const t=e.imageEditorInstance;if(!t){console.warn("No imageEditorInstance provided.");return}const{name:a,path:i,initiatorId:s,requiredAspectRatio:n,minDimensions:o,maxDimensions:d}=e;t.setImage(a,i,s);const l={debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:[n],selectionAspectRatio:n,minWidth:o.width,minHeight:o.height,maxWidth:d.width,maxHeight:d.height,imagePropertiesEnabled:!1,fileFormatEnabled:!1,rotationEnabled:!0,mirroringEnabled:!0,selectingEnabled:!0,croppingEnabled:!0,gridEnabled:!1,downloadingEnabled:!1,freeSelectEnabled:!1,freeRotationEnabled:!1,resizingEnabled:!1,filtersEnabled:!1,selectionInfoEnabled:!1,selectionAspectRatioEnabled:!1,helpEnabled:!1};t.setConfiguration(l)}function r(e){if(e.dataset.mleImageEditorInitialized)return;const t=e.querySelector("[data-mle-image-editor-placeholder]");e.addEventListener("show.bs.modal",function(){const a=JSON.parse(e.querySelector("[data-mle-image-editor-modal-config]").value),i=e.getAttribute("data-mle-medium-path"),s=e.getAttribute("data-mle-medium-display-name"),n=e.getAttribute("data-mle-medium-forced-aspect-ratio")??"4:3",o=c(e.getAttribute("data-mle-medium-minimal-dimensions"),{width:800,height:600}),d=c(e.getAttribute("data-mle-medium-maximal-dimensions"),{width:7040,height:3960}),l=a.initiatorId;if(!customElements.get("image-editor")){console.warn("<image-editor> custom element is not registered.");return}t.innerHTML="";const m=document.createElement("image-editor");m.id="my-image-editor",m.addEventListener("imageEditorReady",g=>{E({imageEditorInstance:g.detail.imageEditorInstance,name:s,path:i,initiatorId:l,requiredAspectRatio:n,minDimensions:o,maxDimensions:d})},{once:!0}),t.appendChild(m)}),e.addEventListener("hidden.bs.modal",function(){t.innerHTML=""}),e.dataset.mleImageEditorInitialized="true"}function c(e,t){if(!e)return t;const[a,i]=e.split(/[x:]/).map(Number);return{width:a||t.width,height:i||t.height}}document.addEventListener("mediaManagerPreviewsUpdated",e=>{e.detail.mediaManager.querySelectorAll("[data-mle-image-editor-modal]").forEach(r)});document.addEventListener("imageEditorModalCloseRequest",e=>{const t=e.detail.modal;f(t)});const h=()=>{new MutationObserver(t=>{for(const a of t)for(const i of a.addedNodes)i instanceof HTMLElement&&(i.matches("[data-mle-image-editor-modal]")&&r(i),i.querySelectorAll?.("[data-mle-image-editor-modal]").forEach(r))}).observe(document.body,{childList:!0,subtree:!0})};h();document.querySelectorAll("[data-mle-image-editor-modal]").forEach(r);

import{h as s}from"./xhrStatus.js";import{e as m,d as n}from"./form.js";async function c(t,e,i={}){const l=t.querySelector("[data-mle-media-preview-grid]"),d=t.querySelectorAll("[data-mle-form], [data-mle-xhr-form]");if(!l)return;const o=new URLSearchParams({model_type:e.modelType,model_id:e.modelId,single_medium_id:i.singleMediumId??null,temporary_upload_mode:e.temporaryUploadMode,initiator_id:e.id,collections:JSON.stringify(e.collections),options:JSON.stringify(e.options),disabled:e.disabled,readonly:e.readonly,selectable:e.selectable,multiple:e.multiple});o.append("_",Date.now());try{const a=await fetch(`${e.mediaManagerPreviewUpdateRoute}?${o}`,{headers:{Accept:"application/json"},cache:"no-store"}),r=await a.json();if(!a.ok){s(a,r);return}if(!r.html)return;l.innerHTML=r.html,!e.multiple&&r.mediaCount!==void 0&&r.mediaCount!==null&&(r.mediaCount<1?m(d):n(d)),document.dispatchEvent(new CustomEvent("mediaManagerPreviewsUpdated",{bubbles:!1,detail:{mediaManager:t,previewGrid:l}}))}catch(a){console.error("Error refreshing media manager:",a)}}export{c as u};

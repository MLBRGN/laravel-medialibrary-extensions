let u={},l={};const g=function(r){if(r.dataset.imageEditorInitialized)return;const n=r.querySelector(".media-carousel"),p=r.id;function E(e){const t=e.getAttribute("data-youtube-video-id"),a=p+"-"+t,o=e.querySelector("lite-youtube").shadowRoot.querySelector("iframe");u[a]=new YT.Player(o,{events:{onReady:()=>{u[a].isReady=!0}}})}function v(e){const t=e.querySelector("audio"),a=e.querySelector("video");let o=null;return t&&(o=t.id,l[o]=t),a&&(o=a.id,l[o]=a),o}function f(e,t){const a=l[e];if(a)try{t==="play"?a.play():t==="pause"&&a.pause()}catch(o){console.warn(`Failed to ${t} media:`,o)}}r.addEventListener("liteYoutubeIframeLoaded",e=>{const t=e.target.closest("[data-youtube-video-id]");t&&E(t)}),r.addEventListener("shown.bs.modal",e=>{if(!r.hasAttribute("data-autoplay"))return;const t=e.relatedTarget;if(!t)return;const a=t.querySelector("[data-bs-slide-to]");if(!a||a.getAttribute("data-bs-slide-to")!=="0")return;const i=n.querySelector(".carousel-item:first-child");if(!i)return;const s=v(i);f(s,"play");const y=i.querySelector("[data-mle-youtube-video]");if(y){const d=y.getAttribute("data-youtube-video-id");if(!d)return;const I=`${p}-${d}`;c(I,"playVideo")}}),r.addEventListener("hidden.bs.modal",()=>{const e=r.querySelector(".media-carousel");if(!e)return;const t=bootstrap.Carousel.getInstance(e);t&&(m(),n.removeEventListener("slide.bs.carousel",b),t.to(0),n.addEventListener("slide.bs.carousel",b))});const b=e=>{if(!r.hasAttribute("data-autoplay"))return;h();const t=e.relatedTarget;if(!t)return;const a=v(t);f(a,"play");const o=t.querySelector("[data-mle-youtube-video]");if(o&&o.hasAttribute("data-youtube-video-id")){let i=o.getAttribute("data-youtube-video-id");const s=p+"-"+i;c(s,"playVideo")}};n.addEventListener("slide.bs.carousel",b),r.addEventListener("keydown",e=>{if(!r.classList.contains("show"))return;const t=r.querySelector(".media-carousel");if(!t)return;const a=bootstrap.Carousel.getInstance(t);if(!a)return;const o=n.contains(e.target);(e.key==="ArrowLeft"||e.key==="ArrowRight")&&o||(e.key==="ArrowLeft"?(e.preventDefault(),e.stopPropagation(),a.prev()):e.key==="ArrowRight"&&(e.preventDefault(),e.stopPropagation(),a.next()))}),r.dataset.imageEditorInitialized="true";function c(e,t="playVideo",a=0,o=10,i=200){const s={playVideo:"playVideo",pauseVideo:"pauseVideo",stopVideo:"stopVideo"},y=s[t];if(!s[t]){console.warn(`Unknown action: ${t}`);return}const d=u[e];if(!d||!d.isReady){a<o&&setTimeout(()=>c(e,t,a+1,o,i*1.2),i);return}y&&d[y]()}function h(){Object.keys(u).forEach(e=>c(e,"pauseVideo")),Object.keys(l).forEach(e=>f(e,"pause"))}function m(){console.log("stopAllMediaPlayBack"),Object.keys(u).forEach(e=>c(e,"stopVideo")),Object.keys(l).forEach(e=>f(e,"pause"))}};document.addEventListener("mediaManagerPreviewsUpdated",r=>{u={},l={},r.detail.mediaManager.querySelectorAll(".media-modal").forEach(g)});document.querySelectorAll(".media-modal").forEach(g);

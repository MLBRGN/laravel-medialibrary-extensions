import{h as s}from"./xhrStatus.js";import{e as m,d as n}from"./form.js";async function c(a,e,i={}){const d=a.querySelector("[data-media-preview-grid]"),l=a.querySelectorAll("[data-form], [data-xhr-form]");if(!d)return;const o=new URLSearchParams({model_type:e.modelType,model_id:e.modelId,single_medium_id:i.singleMediumId??null,temporary_upload_mode:e.temporaryUploadMode,initiator_id:e.id,collections:JSON.stringify(e.collections),options:JSON.stringify(e.options),disabled:e.disabled,readonly:e.readonly,selectable:e.selectable,multiple:e.multiple});try{const t=await fetch(`${e.mediaManagerPreviewUpdateRoute}?${o}`,{headers:{Accept:"application/json"}}),r=await t.json();if(!t.ok){s(t,r);return}if(!r.html)return;d.innerHTML=r.html,!e.multiple&&r.mediaCount!==void 0&&r.mediaCount!==null&&(r.mediaCount<1?m(l):n(l)),document.dispatchEvent(new CustomEvent("mediaManagerPreviewsUpdated",{bubbles:!1,detail:{mediaManager:a,previewGrid:d}}))}catch(t){console.error("Error refreshing media manager:",t)}}export{c as u};

import{h as s}from"./xhrStatus.js";import{e as n,d as m}from"./form.js";async function c(t,e,i={}){const d=t.querySelector("[data-media-preview-grid]"),o=t.querySelectorAll("[data-form], [data-xhr-form]");if(!d)return;const l=new URLSearchParams({model_type:e.modelType,model_id:e.modelId,single_medium_id:i.singleMediumId??null,temporary_upload_mode:e.temporaryUploadMode,initiator_id:e.id,collections:JSON.stringify(e.collections),options:JSON.stringify(e.options),disabled:e.disabled,readonly:e.readonly,selectable:e.selectable,multiple:e.multiple});l.append("_",Date.now());try{const a=await fetch(`${e.mediaManagerPreviewUpdateRoute}?${l}`,{headers:{Accept:"application/json"},cache:"no-store"}),r=await a.json();if(!a.ok){s(a,r);return}if(!r.html)return;d.innerHTML=r.html,!e.multiple&&r.mediaCount!==void 0&&r.mediaCount!==null&&(r.mediaCount<1?n(o):m(o)),document.dispatchEvent(new CustomEvent("mediaManagerPreviewsUpdated",{bubbles:!1,detail:{mediaManager:t,previewGrid:d}}))}catch(a){console.error("Error refreshing media manager:",a)}}export{c as u};

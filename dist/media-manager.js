import{a as E,s as v,b as l,c as u,h as A,r as S}from"./general-helpers.js";document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("[data-media-manager]").forEach(t=>{const e=t.querySelector(".media-manager-form"),a=E(t);if(!a){console.log("could not get config");return}console.log(a),t.addEventListener("click",function(r){const s=r.target.closest("[data-action]");if(!s)return;r.preventDefault();const p=s.getAttribute("data-action"),c=s.closest("[data-xhr-form]");v(e);const y=g(c),i={"upload-media":a.mediaUploadRoute,"upload-youtube-medium":a.youtubeUploadRoute},d=s.closest(".media-manager-preview-media-container");d&&(i["destroy-medium"]=d.dataset.destroyRoute||"",i["set-as-first"]=d.dataset.setAsFirstRoute||"");const f=i[p];if(!f){l(e,{type:"error",message:"Invalid action"}),u(e);return}fetch(f,{method:"POST",headers:{"X-CSRF-TOKEN":a.csrfToken,Accept:"application/json"},body:y}).then(async n=>{const o=await n.json();if(!n.ok){console.log("callback image editor handleAjaxError",o),A(n,o,function(){console.log("callback media manager handleAjaxError",o),l(e,o)});return}l(e,o);const m=document.getElementById(c.dataset.target+"-flash");m&&o.message&&(m.innerHTML=`<div class="alert alert-${o.type}">${o.message}</div>`),S(t),h(c)}).catch(n=>{console.error("Error during upload:",n)}).finally(()=>{u(e)})})});function g(t){const e=new FormData;return t.querySelectorAll("input").forEach(a=>{a.type==="file"?[...a.files].forEach(r=>{e.append(a.name,r)}):e.append(a.name,a.value)}),e}function h(t){t.querySelectorAll("input").forEach(e=>{e.type!=="hidden"&&(e.value="")})}});

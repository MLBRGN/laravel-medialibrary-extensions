import{a as d,t as g,s as A,h as E,b as S}from"./xhrStatus.js";import{u as T}from"./media-manager-lab-previews-refresher.js";import{g as v}from"./form.js";import{g as C}from"./media-manager-config.js";const w=document.querySelectorAll("[data-media-manager-lab]");w.forEach(t=>{const o=t.querySelector("[data-status-area-container]");t.addEventListener("click",async function(a){const r=C(t);if(!r||!r.useXhr)return;const e=a.target.closest("[data-action]"),u=e==null?void 0:e.getAttribute("data-action");if(!u)return;a.preventDefault();const l=e.dataset.mediumId;if(!e)return;const n=e.closest("[data-xhr-form]"),y=(n==null?void 0:n.getAttribute("data-xhr-method"))??"post",m=I(u,e);if(!m){d(o,{type:"error",message:g("invalid_action")});return}A(o);try{const s=v(n),p=y.toUpperCase();["DELETE","PUT","PATCH"].includes(p)&&s.append("_method",p);const c=await fetch(m,{method:"POST",headers:{"X-CSRF-TOKEN":r.csrfToken,Accept:"application/json"},body:s}),f=await c.json();if(!c.ok){E(c,f,o);return}d(o,f),t.style.border="10px solid hotpink";const h=document.createElement("div");console.log(t),h.innerHTML="mediaManagerLab id:"+t.id+" mediumId: "+l+"config.initiatorId:  "+r.initatorId,t.appendChild(h),T(t,r,l,{})}catch(s){console.error("Error during upload:",s),d(o,{type:"error",message:g("upload_failed")})}finally{S(o)}})});function I(t,o,a){var i;return{"medium-restore":(i=o==null?void 0:o.dataset)==null?void 0:i.route}[t]||null}

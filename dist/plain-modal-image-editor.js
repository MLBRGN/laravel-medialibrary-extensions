import{r as g,i as p,c as s,s as f}from"./_modal-core.js";import"./_helpers.js";const d=new WeakMap;function l(e){if(e.dataset.imageEditorInitialized)return;const t=e.querySelector("[data-image-editor-placeholder]");f(e,()=>{const a=d.get(e);a&&(a.remove(),d.delete(e))},()=>{if(d.has(e))return;let a={};try{const o=e.querySelector(".image-editor-modal-config");o&&(a=JSON.parse(o.value))}catch(o){console.error("Invalid or missing image-editor-modal-config:",o)}const c=e.dataset.mediumPath,m=e.dataset.mediumDisplayName,u=a.initiatorId,i=document.createElement("image-editor");i.id="my-image-editor",i.dataset.mediumDisplayName=m,i.dataset.mediumPath=c,i.dataset.initiatorId=u,i.addEventListener("imageEditorReady",o=>{E(o.detail)},{once:!0}),t.appendChild(i),d.set(e,i)}),e.dataset.imageEditorInitialized="true"}function E(e){const t=e.imageEditorInstance;if(!t)return;const r=t.dataset.initiatorId,n=t.dataset.mediumDisplayName,a=t.dataset.mediumPath;t.setImage(n,a,r),t.setConfiguration({debug:!1,rotateDegreesStep:90,freeSelectDisabled:!0,freeRotateDisabled:!0,freeResizeDisabled:!0,filtersDisabled:!0,selectionAspectRatios:["16:9","4:3"],selectionAspectRatio:"16:9"})}function I(e){const t=e.target.closest("[data-image-editor-modal]");t&&s(t)}g("onImageUpdated",I);p();document.querySelectorAll("[data-image-editor-modal]").forEach(l);document.addEventListener("mediaManagerPreviewsUpdated",e=>{e.detail.mediaManager.querySelectorAll("[data-image-editor-modal]").forEach(l)});document.addEventListener("imageEditorModalCloseRequest",e=>{const t=e.detail.modal;s(t)});
